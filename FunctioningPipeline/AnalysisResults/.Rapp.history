dat <- data.frame(matrix(NA, ncol=5, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1)#
dat[23,] <- c(2.22, 0, 0, 79, 2)#
dat[24,] <- c(2.23, 0, 0, 150, 3)#
dat[25,] <- c(2.24, 0, 0, 227, 7)#
dat[26,] <- c(2.25, 1, 0, 320, 10)#
dat[27,] <- c(2.26, 2, 0, 445, 12)#
dat[28,] <- c(2.27, 8, 0, 650, 17)#
dat[29,] <- c(2.28, 13, 0, 888, 21)#
dat[30,] <- c(2.29, 18, 0, 1128,29 )#
dat[31,] <- c(3.01, 22, 0, 1694, 34)#
dat[32,] <- c(3.02, 40, 0, 2036, 52)#
dat[33,] <- c(3.03, 55, 0, 2502, 79)#
dat[34,] <- c(3.04, 72, 0, 3089, 107)#
dat[35,] <- c(3.05, 102, 1, 3858, 148)#
dat[36,] <- c(3.06, 198, 1, 4636, 197)#
dat[37,] <- c(3.07, 245, 1, 5883, 233)#
dat[38,] <- c(3.08, 352, 2, 7375, 366)#
dat[39,] <- c(3.09, 366, 2, 9172, 463)#
dat[40,] <- c(3.10, 476, 3, 10149, 631)#
plot(1:length(dat$date), dat$cases.italy, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz*1000, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz*1000, col="darkred",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "Cases", "Deaths"), pch=c(15,15,20,25), col=c("green4", "red3", "black", "black"))
dat <- data.frame(matrix(NA, ncol=5, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1)#
dat[23,] <- c(2.22, 0, 0, 79, 2)#
dat[24,] <- c(2.23, 0, 0, 150, 3)#
dat[25,] <- c(2.24, 0, 0, 227, 7)#
dat[26,] <- c(2.25, 1, 0, 320, 10)#
dat[27,] <- c(2.26, 2, 0, 445, 12)#
dat[28,] <- c(2.27, 8, 0, 650, 17)#
dat[29,] <- c(2.28, 13, 0, 888, 21)#
dat[30,] <- c(2.29, 18, 0, 1128,29 )#
dat[31,] <- c(3.01, 22, 0, 1694, 34)#
dat[32,] <- c(3.02, 40, 0, 2036, 52)#
dat[33,] <- c(3.03, 55, 0, 2502, 79)#
dat[34,] <- c(3.04, 72, 0, 3089, 107)#
dat[35,] <- c(3.05, 102, 1, 3858, 148)#
dat[36,] <- c(3.06, 198, 1, 4636, 197)#
dat[37,] <- c(3.07, 245, 1, 5883, 233)#
dat[38,] <- c(3.08, 352, 2, 7375, 366)#
dat[39,] <- c(3.09, 366, 2, 9172, 463)#
dat[40,] <- c(3.10, 476, 3, 10149, 631)#
plot(1:length(dat$date), dat$cases.italy, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz*500, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz*500, col="darkred",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "Cases", "Deaths"), pch=c(15,15,20,25), col=c("green4", "red3", "black", "black"))
dat <- data.frame(matrix(NA, ncol=5, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1)#
dat[23,] <- c(2.22, 0, 0, 79, 2)#
dat[24,] <- c(2.23, 0, 0, 150, 3)#
dat[25,] <- c(2.24, 0, 0, 227, 7)#
dat[26,] <- c(2.25, 1, 0, 320, 10)#
dat[27,] <- c(2.26, 2, 0, 445, 12)#
dat[28,] <- c(2.27, 8, 0, 650, 17)#
dat[29,] <- c(2.28, 13, 0, 888, 21)#
dat[30,] <- c(2.29, 18, 0, 1128,29 )#
dat[31,] <- c(3.01, 22, 0, 1694, 34)#
dat[32,] <- c(3.02, 40, 0, 2036, 52)#
dat[33,] <- c(3.03, 55, 0, 2502, 79)#
dat[34,] <- c(3.04, 72, 0, 3089, 107)#
dat[35,] <- c(3.05, 102, 1, 3858, 148)#
dat[36,] <- c(3.06, 198, 1, 4636, 197)#
dat[37,] <- c(3.07, 245, 1, 5883, 233)#
dat[38,] <- c(3.08, 352, 2, 7375, 366)#
dat[39,] <- c(3.09, 366, 2, 9172, 463)#
dat[40,] <- c(3.10, 476, 3, 10149, 631)#
plot(1:length(dat$date), dat$cases.italy, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz*400, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz*400, col="darkred",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "Cases", "Deaths"), pch=c(15,15,20,25), col=c("green4", "red3", "black", "black"))
dat <- data.frame(matrix(NA, ncol=5, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1)#
dat[23,] <- c(2.22, 0, 0, 79, 2)#
dat[24,] <- c(2.23, 0, 0, 150, 3)#
dat[25,] <- c(2.24, 0, 0, 227, 7)#
dat[26,] <- c(2.25, 1, 0, 320, 10)#
dat[27,] <- c(2.26, 2, 0, 445, 12)#
dat[28,] <- c(2.27, 8, 0, 650, 17)#
dat[29,] <- c(2.28, 13, 0, 888, 21)#
dat[30,] <- c(2.29, 18, 0, 1128,29 )#
dat[31,] <- c(3.01, 22, 0, 1694, 34)#
dat[32,] <- c(3.02, 40, 0, 2036, 52)#
dat[33,] <- c(3.03, 55, 0, 2502, 79)#
dat[34,] <- c(3.04, 72, 0, 3089, 107)#
dat[35,] <- c(3.05, 102, 1, 3858, 148)#
dat[36,] <- c(3.06, 198, 1, 4636, 197)#
dat[37,] <- c(3.07, 245, 1, 5883, 233)#
dat[38,] <- c(3.08, 352, 2, 7375, 366)#
dat[39,] <- c(3.09, 366, 2, 9172, 463)#
dat[40,] <- c(3.10, 476, 3, 10149, 631)#
plot(1:length(dat$date), dat$cases.italy, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz*300, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz*300, col="darkred",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "Cases", "Deaths"), pch=c(15,15,20,25), col=c("green4", "red3", "black", "black"))
dat <- data.frame(matrix(NA, ncol=5, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1)#
dat[23,] <- c(2.22, 0, 0, 79, 2)#
dat[24,] <- c(2.23, 0, 0, 150, 3)#
dat[25,] <- c(2.24, 0, 0, 227, 7)#
dat[26,] <- c(2.25, 1, 0, 320, 10)#
dat[27,] <- c(2.26, 2, 0, 445, 12)#
dat[28,] <- c(2.27, 8, 0, 650, 17)#
dat[29,] <- c(2.28, 13, 0, 888, 21)#
dat[30,] <- c(2.29, 18, 0, 1128,29 )#
dat[31,] <- c(3.01, 22, 0, 1694, 34)#
dat[32,] <- c(3.02, 40, 0, 2036, 52)#
dat[33,] <- c(3.03, 55, 0, 2502, 79)#
dat[34,] <- c(3.04, 72, 0, 3089, 107)#
dat[35,] <- c(3.05, 102, 1, 3858, 148)#
dat[36,] <- c(3.06, 198, 1, 4636, 197)#
dat[37,] <- c(3.07, 245, 1, 5883, 233)#
dat[38,] <- c(3.08, 352, 2, 7375, 366)#
dat[39,] <- c(3.09, 366, 2, 9172, 463)#
dat[40,] <- c(3.10, 476, 3, 10149, 631)#
plot(1:length(dat$date), dat$cases.italy, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz*200, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz*200, col="darkred",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "Cases", "Deaths"), pch=c(15,15,20,25), col=c("green4", "red3", "black", "black"))
dat <- data.frame(matrix(NA, ncol=5, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1)#
dat[23,] <- c(2.22, 0, 0, 79, 2)#
dat[24,] <- c(2.23, 0, 0, 150, 3)#
dat[25,] <- c(2.24, 0, 0, 227, 7)#
dat[26,] <- c(2.25, 1, 0, 320, 10)#
dat[27,] <- c(2.26, 2, 0, 445, 12)#
dat[28,] <- c(2.27, 8, 0, 650, 17)#
dat[29,] <- c(2.28, 13, 0, 888, 21)#
dat[30,] <- c(2.29, 18, 0, 1128,29 )#
dat[31,] <- c(3.01, 22, 0, 1694, 34)#
dat[32,] <- c(3.02, 40, 0, 2036, 52)#
dat[33,] <- c(3.03, 55, 0, 2502, 79)#
dat[34,] <- c(3.04, 72, 0, 3089, 107)#
dat[35,] <- c(3.05, 102, 1, 3858, 148)#
dat[36,] <- c(3.06, 198, 1, 4636, 197)#
dat[37,] <- c(3.07, 245, 1, 5883, 233)#
dat[38,] <- c(3.08, 352, 2, 7375, 366)#
dat[39,] <- c(3.09, 366, 2, 9172, 463)#
dat[40,] <- c(3.10, 476, 3, 10149, 631)#
plot(1:length(dat$date), dat$cases.italy, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz*100, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz*100, col="darkred",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "Cases", "Deaths"), pch=c(15,15,20,25), col=c("green4", "red3", "black", "black"))
dat <- data.frame(matrix(NA, ncol=5, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1)#
dat[23,] <- c(2.22, 0, 0, 79, 2)#
dat[24,] <- c(2.23, 0, 0, 150, 3)#
dat[25,] <- c(2.24, 0, 0, 227, 7)#
dat[26,] <- c(2.25, 1, 0, 320, 10)#
dat[27,] <- c(2.26, 2, 0, 445, 12)#
dat[28,] <- c(2.27, 8, 0, 650, 17)#
dat[29,] <- c(2.28, 13, 0, 888, 21)#
dat[30,] <- c(2.29, 18, 0, 1128,29 )#
dat[31,] <- c(3.01, 22, 0, 1694, 34)#
dat[32,] <- c(3.02, 40, 0, 2036, 52)#
dat[33,] <- c(3.03, 55, 0, 2502, 79)#
dat[34,] <- c(3.04, 72, 0, 3089, 107)#
dat[35,] <- c(3.05, 102, 1, 3858, 148)#
dat[36,] <- c(3.06, 198, 1, 4636, 197)#
dat[37,] <- c(3.07, 245, 1, 5883, 233)#
dat[38,] <- c(3.08, 352, 2, 7375, 366)#
dat[39,] <- c(3.09, 366, 2, 9172, 463)#
dat[40,] <- c(3.10, 476, 3, 10149, 631)#
plot(1:length(dat$date), dat$cases.italy, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz*50, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz*50, col="darkred",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "Cases", "Deaths"), pch=c(15,15,20,25), col=c("green4", "red3", "black", "black"))
dat <- data.frame(matrix(NA, ncol=5, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1)#
dat[23,] <- c(2.22, 0, 0, 79, 2)#
dat[24,] <- c(2.23, 0, 0, 150, 3)#
dat[25,] <- c(2.24, 0, 0, 227, 7)#
dat[26,] <- c(2.25, 1, 0, 320, 10)#
dat[27,] <- c(2.26, 2, 0, 445, 12)#
dat[28,] <- c(2.27, 8, 0, 650, 17)#
dat[29,] <- c(2.28, 13, 0, 888, 21)#
dat[30,] <- c(2.29, 18, 0, 1128,29 )#
dat[31,] <- c(3.01, 22, 0, 1694, 34)#
dat[32,] <- c(3.02, 40, 0, 2036, 52)#
dat[33,] <- c(3.03, 55, 0, 2502, 79)#
dat[34,] <- c(3.04, 72, 0, 3089, 107)#
dat[35,] <- c(3.05, 102, 1, 3858, 148)#
dat[36,] <- c(3.06, 198, 1, 4636, 197)#
dat[37,] <- c(3.07, 245, 1, 5883, 233)#
dat[38,] <- c(3.08, 352, 2, 7375, 366)#
dat[39,] <- c(3.09, 366, 2, 9172, 463)#
dat[40,] <- c(3.10, 476, 3, 10149, 631)#
plot(1:length(dat$date), dat$cases.italy, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "Cases", "Deaths"), pch=c(15,15,20,25), col=c("green4", "red3", "black", "black"))
dat <- data.frame(matrix(NA, ncol=5, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1)#
dat[23,] <- c(2.22, 0, 0, 79, 2)#
dat[24,] <- c(2.23, 0, 0, 150, 3)#
dat[25,] <- c(2.24, 0, 0, 227, 7)#
dat[26,] <- c(2.25, 1, 0, 320, 10)#
dat[27,] <- c(2.26, 2, 0, 445, 12)#
dat[28,] <- c(2.27, 8, 0, 650, 17)#
dat[29,] <- c(2.28, 13, 0, 888, 21)#
dat[30,] <- c(2.29, 18, 0, 1128,29 )#
dat[31,] <- c(3.01, 22, 0, 1694, 34)#
dat[32,] <- c(3.02, 40, 0, 2036, 52)#
dat[33,] <- c(3.03, 55, 0, 2502, 79)#
dat[34,] <- c(3.04, 72, 0, 3089, 107)#
dat[35,] <- c(3.05, 102, 1, 3858, 148)#
dat[36,] <- c(3.06, 198, 1, 4636, 197)#
dat[37,] <- c(3.07, 245, 1, 5883, 233)#
dat[38,] <- c(3.08, 352, 2, 7375, 366)#
dat[39,] <- c(3.09, 366, 2, 9172, 463)#
dat[40,] <- c(3.10, 476, 3, 10149, 631)#
dat[41,] <- c(3.11, 476, 3, 12462, 827)#
plot(1:length(dat$date), dat$cases.italy, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "Cases", "Deaths"), pch=c(15,15,20,25), col=c("green4", "red3", "black", "black"))
dat <- data.frame(matrix(NA, ncol=5, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1)#
dat[23,] <- c(2.22, 0, 0, 79, 2)#
dat[24,] <- c(2.23, 0, 0, 150, 3)#
dat[25,] <- c(2.24, 0, 0, 227, 7)#
dat[26,] <- c(2.25, 1, 0, 320, 10)#
dat[27,] <- c(2.26, 2, 0, 445, 12)#
dat[28,] <- c(2.27, 8, 0, 650, 17)#
dat[29,] <- c(2.28, 13, 0, 888, 21)#
dat[30,] <- c(2.29, 18, 0, 1128,29 )#
dat[31,] <- c(3.01, 22, 0, 1694, 34)#
dat[32,] <- c(3.02, 40, 0, 2036, 52)#
dat[33,] <- c(3.03, 55, 0, 2502, 79)#
dat[34,] <- c(3.04, 72, 0, 3089, 107)#
dat[35,] <- c(3.05, 102, 1, 3858, 148)#
dat[36,] <- c(3.06, 198, 1, 4636, 197)#
dat[37,] <- c(3.07, 254, 1, 5883, 233)#
dat[38,] <- c(3.08, 350, 2, 7375, 366)#
dat[39,] <- c(3.09, 369, 2, 9172, 463)#
dat[40,] <- c(3.10, 480, 3, 10149, 631)#
dat[41,] <- c(3.11, 640, 4, 12462, 827)#
dat[42,] <- c(3.12, 864, 6, 15113, 1016)#
dat[42,] <- c(3.13, 864, 6, 17660, 1266)#
#
pop.factor <- 7.05#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "Cases", "Deaths"), pch=c(15,15,20,25), col=c("green4", "red3", "black", "black"))
dat <- data.frame(matrix(NA, ncol=5, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 8)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 9)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 10)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 18)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 19)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 26)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 37)#
dat[42,] <- c(3.12, 864, 6, 15113, 1016, 1598, 41)#
dat[42,] <- c(3.13, 864, 6, 17660, 1266, 2051, 41)#
#
pop.factor <- 7.05#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green4", "red3", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 8)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 9)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 10)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 18)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 19)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 26)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 37)#
dat[42,] <- c(3.12, 864, 6, 15113, 1016, 1598, 41)#
dat[42,] <- c(3.13, 864, 6, 17660, 1266, 2051, 41)#
#
pop.factor <- 7.05#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green4", "red3", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 8)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 9)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 10)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 18)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 19)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 26)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 37)#
dat[42,] <- c(3.12, 864, 6, 15113, 1016, 1598, 41)#
dat[42,] <- c(3.13, 864, 6, 17660, 1266, 2051, 41)#
#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green4", "red3", "blue", "black", "black"))
length(dat[,1])
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 8)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 9)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 10)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 18)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 19)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 26)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 37)#
dat[42,] <- c(3.12, 864, 6, 15113, 1016, 1598, 41)#
dat[42,] <- c(3.13, 864, 6, 17660, 1266, 2051, 41)#
#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])))#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green4", "red3", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 8)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 9)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 10)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 18)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 19)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 26)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 37)#
dat[42,] <- c(3.12, 864, 6, 15113, 1016, 1598, 41)#
dat[42,] <- c(3.13, 864, 6, 17660, 1266, 2051, 41)#
#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])))#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red3", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 8)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 9)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 10)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 18)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 19)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 26)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 37)#
dat[42,] <- c(3.12, 864, 6, 15113, 1016, 1598, 41)#
dat[42,] <- c(3.13, 864, 6, 17660, 1266, 2051, 41)#
#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])))#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1129, 11, 21157, 1441, 2488, 50)#
#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])))#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1129, 11, 21157, 1441, 2488, 50)#
par(mfrow(c=3,1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])))#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])))#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1129, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])))#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])))#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1129, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1,1,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])))#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1129, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])))#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1129, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(6:length(dat$date), dat$cases.switz[-1:5], col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
6:length(dat$date)
length(6:length(dat$date))
length(dat$cases.switz[-1:5])
points(6:length(dat$date), dat$cases.switz[-c(1:5)], col="red",  type="o", pch=20, lwd=2)
length(dat$cases.switz[-c(1:5)])
1:length(dat$date)-5
length()
length(1:length(dat$date)-5)
length((1:(length(dat$date)-5))
)
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-5), dat$cases.switz[-c(1:5)], col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-5), dat$cases.switz[-c(1:5)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-5), dat$deaths.switz[-c(1:5)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-16), dat$cases.us/pop.factor2[-c(1:16)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.us/pop.factor2[-c(1:16)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us/pop.factor2[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us/pop.factor2[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-5), dat$cases.us/pop.factor2[-c(1:5)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-5), dat$deaths.us/pop.factor2[-c(1:5)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat$cases.us/pop.factor2[-c(1:5)]
dat$cases.us
dat$cases.us/pop.factor2
dat$cases.us/pop.factor2[-c(1:5)]
(dat$cases.us/pop.factor2)[-c(1:5)]
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-5), (dat$cases.us/pop.factor2)[-c(1:5)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-5), (dat$deaths.us/pop.factor2)[-c(1:5)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="", ylim=c(0,1000))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-5), (dat$cases.us/pop.factor2)[-c(1:5)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-5), (dat$deaths.us/pop.factor2)[-c(1:5)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="", ylim=c(0,100))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-5), (dat$cases.us/pop.factor2)[-c(1:5)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-5), (dat$deaths.us/pop.factor2)[-c(1:5)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="", ylim=c(0,200))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-5), (dat$cases.us/pop.factor2)[-c(1:5)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-5), (dat$deaths.us/pop.factor2)[-c(1:5)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(22, length(dat[,1])), xlab="", ylab="", ylim=c(0,200))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="", ylim=c(0,200))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(15, length(dat[,1])), xlab="", ylab="", ylim=c(0,200))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(15, length(dat[,1])), xlab="", ylab="", ylim=c(0,200))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
#points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
#points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(15, length(dat[,1])), xlab="", ylab="", ylim=c(0,200))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(15, length(dat[,1])), xlab="", ylab="", ylim=c(0,200))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-16), (dat$cases.us/pop.factor2)[-c(1:16)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), (dat$deaths.us/pop.factor2)[-c(1:16)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(15, length(dat[,1])), xlab="", ylab="", ylim=c(0,200))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-16), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(15, length(dat[,1])), xlab="", ylab="", ylim=c(0,200))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(18, length(dat[,1])), xlab="", ylab="", ylim=c(0,200))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="", ylim=c(0,200))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="", ylim=c(0,2000))#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2157, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2488, 50)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 854, 6, 15113, 1016, 1598, 40)#
dat[42,] <- c(3.13, 1125, 11, 17660, 1266, 2160, 49)#
dat[43,] <- c(3.14, 1189, 11, 21157, 1441, 2820, 55)#
dat[43,] <- c(3.15, 1563, 14, 24747, 1809, 3155, 62)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(3,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), dat$cases.us[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), dat$deaths.us[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
max(dat)
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.1,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), dat$cases.us[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), dat$deaths.us[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(10, length(dat[,1])), ylim=c(0.1,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), dat$cases.us[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), dat$deaths.us[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(1.5,1.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.1,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), dat$cases.us[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), dat$deaths.us[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.1,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), dat$cases.us[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), dat$deaths.us[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), dat$cases.us[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), dat$deaths.us[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat$cases.us
dat$cases.switz
dat$cases.italy
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-0), dat$cases.switz[-c(0)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-0), dat$deaths.switz[-c(0)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-0), dat$cases.us[-c(0)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-0), dat$deaths.us[-c(0)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-1), dat$cases.switz[-c(1)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-1), dat$deaths.switz[-c(1)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-1), dat$cases.us[-c(1)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-1), dat$deaths.us[-c(1)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-5), dat$cases.switz[-c(1:5)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-5), dat$deaths.switz[-c(1:5)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-1), dat$cases.us[-c(1)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-1), dat$deaths.us[-c(1)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-1), dat$cases.us[-c(1)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-1), dat$deaths.us[-c(1)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-7), dat$cases.switz[-c(1:7)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-7), dat$deaths.switz[-c(1:7)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-1), dat$cases.us[-c(1)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-1), dat$deaths.us[-c(1)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-7), dat$cases.switz[-c(1:7)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-17), dat$deaths.switz[-c(1:17)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-1), dat$cases.us[-c(1)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-1), dat$deaths.us[-c(1)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-7), dat$cases.switz[-c(1:7)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-1), dat$cases.us[-c(1)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-1), dat$deaths.us[-c(1)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-7), dat$cases.switz[-c(1:7)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-1), dat$cases.us[-c(1)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-7), dat$cases.switz[-c(1:7)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-1), dat$cases.us[-c(1)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-8), dat$deaths.us[-c(1:8)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-7), dat$cases.switz[-c(1:7)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-5), dat$cases.us[-c(1:5)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-8), dat$deaths.us[-c(1:8)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(1, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-7), dat$cases.switz[-c(1:7)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.us[-c(1:6)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-8), dat$deaths.us[-c(1:8)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(10, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-7), dat$cases.switz[-c(1:7)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.us[-c(1:6)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-8), dat$deaths.us[-c(1:8)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(18, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-7), dat$cases.switz[-c(1:7)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.us[-c(1:6)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-8), dat$deaths.us[-c(1:8)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(18, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-9), dat$cases.switz[-c(1:9)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-8), dat$cases.us[-c(1:8)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-8), dat$deaths.us[-c(1:8)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(18, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-8), dat$deaths.us[-c(1:8)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2200, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(16, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-8), dat$deaths.us[-c(1:8)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3488, 60)#
dat[45,] <- c(3.16, 2330, 15, 27980, 2158, 4138, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(16, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-8), dat$deaths.us[-c(1:8)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 60)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 60)#
dat[46,] <- c(3.17, 2700, 15, 31506, 2158, 5702, 60)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(16, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-8), dat$deaths.us[-c(1:8)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 60)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 60)#
dat[46,] <- c(3.17, 2742, 21, 31506, 2503, 5711, 94)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(16, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-16), dat$deaths.switz[-c(1:16)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-8), dat$deaths.us[-c(1:8)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=7, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 50)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 60)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 60)#
dat[46,] <- c(3.17, 2742, 21, 31506, 2503, 5711, 94)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(16, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2742, 21, 31506, 2503, 5637, 90, 67, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(16, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.va[-c(1:10)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.va[-c(1:10)], col="orange",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(16, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.va[-c(1:10)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.va[-c(1:10)], col="orange",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(16, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-20), dat$cases.va[-c(1:20)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-20), dat$deaths.va[-c(1:20)], col="orange",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(16, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-25), dat$cases.va[-c(1:25)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-25), dat$deaths.va[-c(1:25)], col="orange",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(16, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-24), dat$cases.va[-c(1:24)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-24), dat$deaths.va[-c(1:24)], col="orange",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(16, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-23), dat$cases.va[-c(1:23)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-23), dat$deaths.va[-c(1:23)], col="orange",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(16, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-23), dat$cases.va[-c(1:23)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-23), dat$deaths.va[-c(1:23)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(15, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-23), dat$cases.va[-c(1:23)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-23), dat$deaths.va[-c(1:23)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-23), dat$cases.va[-c(1:23)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-23), dat$deaths.va[-c(1:23)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2742, 21, 31506, 2503, 5637, 90, 67, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-23), dat$cases.va[-c(1:23)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-23), dat$deaths.va[-c(1:23)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-23), dat$cases.va[-c(1:23)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-23), dat$deaths.va[-c(1:23)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-12), dat$cases.switz[-c(1:12)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-12), dat$deaths.switz[-c(1:12)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.us[-c(1:11)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.us[-c(1:11)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2742, 21, 31506, 2503, 5637, 90, 67, 2)#
dat[46,] <- c(3.18, 3028, 21, 35713, 2503, 5637, 90, 77, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2742, 21, 31506, 2503, 5637, 90, 67, 2)#
dat[46,] <- c(3.18, 3028, 21, 35713, 2503, 7769, 90, 77, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 21, 31506, 2503, 5656, 90, 67, 2)#
dat[47,] <- c(3.18, 3070, 21, 35713, 2978, 8054, 90, 77, 2)#
#dat[48,] <- c(3.19, 3070, 21, 35713, 2978, 8054, 90, 77, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 21, 31506, 2503, 5656, 90, 67, 2)#
dat[47,] <- c(3.18, 3028, 21, 35713, 2978, 8054, 90, 77, 2)#
dat[48,] <- c(3.19, 3888, 33, 35713, 2978, 9415, 90, 94, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 21, 31506, 2503, 5656, 90, 67, 2)#
dat[47,] <- c(3.18, 3028, 21, 35713, 2978, 8054, 90, 77, 2)#
dat[48,] <- c(3.19, 3888, 33, 35713, 2978, 10755, 90, 94, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 21, 31506, 2503, 5656, 90, 67, 2)#
dat[47,] <- c(3.18, 3028, 21, 35713, 2978, 8054, 90, 77, 2)#
dat[48,] <- c(3.19, 3888, 33, 41035, 3405, 10755, 90, 94, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 21, 31506, 2503, 5656, 90, 67, 2)#
dat[47,] <- c(3.18, 3028, 21, 35713, 2978, 8054, 131, 77, 2)#
dat[48,] <- c(3.19, 3888, 33, 41035, 3405, 10755, 171, 94, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 68, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 86, 51, 2)#
dat[46,] <- c(3.17, 2677, 21, 31506, 2503, 5656, 109, 67, 2)#
dat[47,] <- c(3.18, 3028, 21, 35713, 2978, 8054, 150, 77, 2)#
dat[48,] <- c(3.19, 3888, 33, 41035, 3405, 10755, 171, 94, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 68, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 86, 51, 2)#
dat[46,] <- c(3.17, 2677, 21, 31506, 2503, 5656, 109, 67, 2)#
dat[47,] <- c(3.18, 3028, 21, 35713, 2978, 8054, 150, 77, 2)#
dat[48,] <- c(3.19, 3888, 33, 41035, 3405, 10755, 171, 94, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 30, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 36, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 68, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 86, 51, 2)#
dat[46,] <- c(3.17, 2677, 21, 31506, 2503, 5656, 109, 67, 2)#
dat[47,] <- c(3.18, 3028, 21, 35713, 2978, 8054, 150, 77, 2)#
dat[48,] <- c(3.19, 4075, 33, 41035, 3405, 13159, 171, 94, 2)
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 11, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 13, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 15, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 15, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 21, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 21, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 33, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 43, 47021, 4032, 16009, 181, 114, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17235, 221, 114, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
#______________________________________________________________##
# time and pop size correction#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17235, 221, 114, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17235, 221, 114, 2)#
dat[50,] <- c(3.21, 6284, 53, 53578, 4825, 22177, 221, 152, 2)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17235, 221, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23623, 221, 152, 2)#
dat[51,] <- c(3.22, 6284, 98, 53578, 4825, 27004, 326, 219, 3)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17235, 221, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23623, 221, 152, 2)#
dat[51,] <- c(3.22, 7674, 98, 53578, 4825, 27004, 326, 219, 3)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42752, 516, 254, 6)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42752, 516, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 50206, 516, 254, 6)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42752, 516, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 50206, 516, 290, 7)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42752, 516, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 51825, 670, 290, 7)#
dat[54,] <- c(3.25, 10746, 152, 69176, 6820, 55568, 670, 391, 9)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42752, 516, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 51825, 670, 290, 7)#
dat[54,] <- c(3.25, 10909, 153, 74386, 7503, 61062, 838, 391, 9)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 516, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 51685, 670, 290, 7)#
dat[54,] <- c(3.25, 10909, 153, 74386, 7503, 64661, 929, 391, 9)#
dat[55,] <- c(3.26, 11888, 188, 80589, 8215, 79313, 1081, 460, 13)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 516, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 51685, 670, 290, 7)#
dat[54,] <- c(3.25, 10909, 153, 74386, 7503, 64661, 929, 391, 9)#
dat[55,] <- c(3.26, 11888, 188, 80589, 8215, 81781, 11147, 460, 13)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 516, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 51685, 670, 290, 7)#
dat[54,] <- c(3.25, 10909, 153, 74386, 7503, 64661, 929, 391, 9)#
dat[55,] <- c(3.26, 11888, 188, 80589, 8215, 81781, 1147, 460, 13)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 516, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 51685, 670, 290, 7)#
dat[54,] <- c(3.25, 10909, 153, 74386, 7503, 64661, 929, 391, 9)#
dat[55,] <- c(3.26, 11888, 188, 80589, 8215, 81781, 1147, 460, 13)#
dat[56,] <- c(3.27, 11888, 188, 80589, 8215, 81781, 1147, 460, 13)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 516, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 51685, 670, 290, 7)#
dat[54,] <- c(3.25, 10909, 153, 74386, 7503, 64661, 929, 391, 9)#
dat[55,] <- c(3.26, 11888, 188, 80589, 8215, 81781, 1147, 460, 13)#
#dat[56,] <- c(3.27, 11888, 188, 80589, 8215, 81781, 1147, 460, 13)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121099, 2038, 739, 17)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
# pop.factor <- 7.05#
# pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
# points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")
pop.factor <- 7.05
pop.factor2 <- 38.1
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="", log="y")
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)) xlab="", ylab="", log="y")
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121099, 2038, 739, 17)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121099, 2038, 739, 17)#
dat[58,] <- c(3.29, 14897, 300, 97689, 10779, 136880, 2038, 890, 22)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121099, 2038, 739, 17)#
dat[58,] <- c(3.29, 14897, 300, 97689, 10779, 141701, 2462, 890, 22)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 141288, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 162126, 2968, 1020, 25)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 141288, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 162161, 2969, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 185791, 3737, 1250, 27)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18001, 497, 110574, 13155, 216722, 4745, 1706, 41)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 234462, 4745, 1706, 41)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19706, 607, 119827, 14681, 273880, 5821, 2012, 46)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307036, 8352, 2407, 52)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307036, 8352, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 331151, 8352, 2637, 52)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 333593, 9534, 2878, 54)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 333593, 9534, 2878, 54)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")
points(1:60, exp(1:60), type="l")
points(1:60, exp(1:60)/10, type="l")
exp(1:60)
points(1:60, exp(0.1:6), type="l")
points(1:60, exp(1:60)/100, type="l")
points(1:60, exp(1:60)/1000, type="l")
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 333593, 9534, 2878, 54)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:60, exp(1:60)/1000, type="l")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
points(1:60, exp(1:60)/10000, type="l")
points(1:60, exp(1:60)/100000, type="l")
points(1:60, exp(1:60)/1000000, type="l")
points(1:60, exp(1:60)/10000000, type="l")
points(1:60, exp(1:60)/100000000, type="l")
points(1:60, exp(1:60)/1000000000, type="l")
points(1:60, exp(1:60)/10000000000, type="l")
points(1:60, exp(1:60)/100000000000, type="l")
points(1:60, log(1:60), type="l")
points(1:60, log(1:600), type="l")
points(1:60, (1:60)^10, type="l")
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 333593, 9534, 2878, 54)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:60, (1:60)^10, type="l")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
(1:60)^10
points(1:60, (1:60)^2, type="l")
points(1:60, (1:60)^3, type="l")
points(5:65, (1:60)^3, type="l")
points(5:66, (1:60)^3, type="l")
points(5:4, (1:60)^3, type="l")
points(5:65, (1:60)^3, type="l")
points(5:64, (1:60)^3, type="l")
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 333593, 9534, 2878, 54)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(5:64, (1:60)^3, type="l")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
points(15:74, (1:60)^3, type="l")
points(15:74, (1:60)^2, type="l")
2^(1:60)
points(15:74, 2^(1:60), type="l")
points(15:74, 1^(1:60), type="l")
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 333593, 9534, 2878, 54)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 820, 135586, 17127, 362955, 10748, 3333, 63)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 820, 135586, 17127, 362955, 10748, 3333, 63)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,1e5))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 820, 135586, 17127, 362955, 10748, 3333, 63)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,4e4))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,3e4))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 820, 135586, 17127, 362955, 10748, 3333, 63)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 820, 135586, 17127, 362955, 10748, 3333, 63)#
dat[68,] <- c(4.08, 23280, 895, 139422, 17669, 404352, 10748, 3645, 75)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 820, 135586, 17127, 393602, 12675, 3333, 63)#
dat[68,] <- c(4.08, 23280, 895, 139422, 17669, 404352, 10748, 3645, 75)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 765, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 820, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23280, 895, 139422, 17669, 425746, 14610, 3645, 75)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 425746, 14610, 4509, 121)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 425746, 14610, 4509, 121)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 493567, 18544, 5077, 130)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 493567, 18544, 5077, 130)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 525436, 20454, 5077, 130)#
dat[71,] <- c(4.12, 25415, 1106, 156363, 19899, 553493, 21936, 5274, 141)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 525436, 20454, 5077, 130)#
dat[72,] <- c(4.12, 25415, 1106, 156363, 19899, 553493, 21936, 5274, 141)#
#dat[71,] <- c(4.12, 25415, 1106, 156363, 19899, 553493, 21936, 5274, 141)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 525436, 20454, 5077, 130)#
dat[72,] <- c(4.12, 25415, 1106, 156363, 19899, 553493, 21936, 5274, 141)#
dat[73,] <- c(4.14, 25688, 1138, 159516, 19899, 560891, 21936, 5747, 149)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 525436, 20454, 5077, 130)#
dat[72,] <- c(4.12, 25415, 1106, 156363, 19899, 553493, 21936, 5274, 141)#
dat[73,] <- c(4.13, 25688, 1138, 159516, 20465, 578178, 23398, 5747, 149)#
dat[74,] <- c(4.14, 25931, 1161, 159516, 20465, 583220, 23398, 6171, 154)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 525436, 20454, 5077, 130)#
dat[72,] <- c(4.12, 25415, 1106, 156363, 19899, 553493, 21936, 5274, 141)#
dat[73,] <- c(4.13, 25688, 1138, 159516, 20465, 578178, 23398, 5747, 149)#
dat[74,] <- c(4.14, 25957, 1175, 162488, 21067, 603505, 25708, 6171, 154)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0,max(dat$cases.switz)), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0,max(dat$cases.switz)), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat$cases.switz)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 525436, 20454, 5077, 130)#
dat[72,] <- c(4.12, 25415, 1106, 156363, 19899, 553493, 21936, 5274, 141)#
dat[73,] <- c(4.13, 25688, 1138, 159516, 20465, 578178, 23398, 5747, 149)#
dat[74,] <- c(4.14, 25957, 1175, 162488, 21067, 604165, 25776, 6171, 154)#
dat[75,] <- c(4.15, 26267, 1239, 165155, 21645, 633630, 28214, 6500, 195)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0,max(dat$cases.switz)), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat$cases.switz)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0,max(dat$cases.switz)), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat$cases.switz)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 525436, 20454, 5077, 130)#
dat[72,] <- c(4.12, 25415, 1106, 156363, 19899, 553493, 21936, 5274, 141)#
dat[73,] <- c(4.13, 25688, 1138, 159516, 20465, 578178, 23398, 5747, 149)#
dat[74,] <- c(4.14, 25936, 1175, 162488, 21067, 604165, 25776, 6171, 154)#
dat[75,] <- c(4.15, 26336, 1239, 165155, 21645, 633630, 28214, 6500, 195)#
dat[76,] <- c(4.16, 26574, 1281, 168941, 22170, 641166, 28214, 6889, 208)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0,max(dat$cases.switz)), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat$cases.switz)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 525436, 20454, 5077, 130)#
dat[72,] <- c(4.12, 25415, 1106, 156363, 19899, 553493, 21936, 5274, 141)#
dat[73,] <- c(4.13, 25688, 1138, 159516, 20465, 578178, 23398, 5747, 149)#
dat[74,] <- c(4.14, 25936, 1175, 162488, 21067, 604165, 25776, 6171, 154)#
dat[75,] <- c(4.15, 26336, 1239, 165155, 21645, 633630, 28214, 6500, 195)#
dat[76,] <- c(4.16, 26574, 1281, 168941, 22170, 641166, 28214, 6889, 208)#
dat[77,] <- c(4.17, 26574, 1281, 168941, 22170, 641166, 28214, 6889, 208)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0,max(dat$cases.switz)), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat$cases.switz)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 525436, 20454, 5077, 130)#
dat[72,] <- c(4.12, 25415, 1106, 156363, 19899, 553493, 21936, 5274, 141)#
dat[73,] <- c(4.13, 25688, 1138, 159516, 20465, 578178, 23398, 5747, 149)#
dat[74,] <- c(4.14, 25936, 1175, 162488, 21067, 604165, 25776, 6171, 154)#
dat[75,] <- c(4.15, 26336, 1239, 165155, 21645, 633630, 28214, 6500, 195)#
dat[76,] <- c(4.16, 26732, 1281, 168941, 22170, 665706, 30355, 6889, 208)#
dat[77,] <- c(4.17, 27078, 1327, 172434, 22745, 696621, 32435, 7491, 231)#
dat[78,] <- c(4.18, 27404, 1368, 175925, 23227, 696621, 32435, 8053, 258)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0,max(dat$cases.switz)), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat$cases.switz)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 525436, 20454, 5077, 130)#
dat[72,] <- c(4.12, 25415, 1106, 156363, 19899, 553493, 21936, 5274, 141)#
dat[73,] <- c(4.13, 25688, 1138, 159516, 20465, 578178, 23398, 5747, 149)#
dat[74,] <- c(4.14, 25936, 1175, 162488, 21067, 604165, 25776, 6171, 154)#
dat[75,] <- c(4.15, 26336, 1239, 165155, 21645, 633630, 28214, 6500, 195)#
dat[76,] <- c(4.16, 26732, 1281, 168941, 22170, 665706, 30355, 6889, 208)#
dat[77,] <- c(4.17, 27078, 1327, 172434, 22745, 696621, 32435, 7491, 231)#
dat[78,] <- c(4.18, 27404, 1368, 175925, 23227, 696621, 32435, 8053, 258)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0,max(dat$cases.switz)), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat$cases.switz)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat$cases.switz)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
dat <- data.frame(matrix(NA, ncol=9, nrow=13))#
names(dat) <- c("date", "cases.switz", "deaths.switz", "cases.italy", "deaths.italy", "cases.us", "deaths.us", "cases.va", "deaths.va")#
#
dat[1,] <- c(1.31, 0, 0, 2, 0, 7, 0, 0, 0)#
dat[2,] <- c(2.01, 0, 0, 2, 0, 8, 0, 0, 0)#
dat[3,] <- c(2.02, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[4,] <- c(2.03, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[5,] <- c(2.04, 0, 0, 2, 0, 11, 0, 0, 0)#
dat[6,] <- c(2.05, 0, 0, 2, 0, 12, 0, 0, 0)#
dat[7,] <- c(2.06, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[8,] <- c(2.07, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[9,] <- c(2.08, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[10,] <- c(2.09, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[11,] <- c(2.10, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[12,] <- c(2.11, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[13,] <- c(2.12, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[14,] <- c(2.13, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[15,] <- c(2.14, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[16,] <- c(2.15, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[17,] <- c(2.16, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[18,] <- c(2.17, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[19,] <- c(2.18, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[20,] <- c(2.19, 0, 0, 3, 0, 12, 0, 0, 0)#
dat[21,] <- c(2.20, 0, 0, 3, 0, 14, 0, 0, 0)#
dat[22,] <- c(2.21, 0, 0, 20, 1, 14, 0, 0, 0)#
dat[23,] <- c(2.22, 0, 0, 79, 2, 14, 0, 0, 0)#
dat[24,] <- c(2.23, 0, 0, 150, 3, 14, 0, 0, 0)#
dat[25,] <- c(2.24, 0, 0, 227, 7, 14, 0, 0, 0)#
dat[26,] <- c(2.25, 1, 0, 320, 10, 14, 0, 0, 0)#
dat[27,] <- c(2.26, 2, 0, 445, 12, 15, 0, 0, 0)#
dat[28,] <- c(2.27, 8, 0, 650, 17, 15, 0, 0, 0)#
dat[29,] <- c(2.28, 13, 0, 888, 21, 19, 0, 0, 0)#
dat[30,] <- c(2.29, 18, 0, 1128, 29, 24, 1, 0, 0)#
dat[31,] <- c(3.01, 22, 0, 1694, 34, 42, 2, 0, 0)#
dat[32,] <- c(3.02, 40, 0, 2036, 52, 57, 6, 0, 0)#
dat[33,] <- c(3.03, 55, 0, 2502, 79, 85, 9, 0, 0)#
dat[34,] <- c(3.04, 72, 0, 3089, 107, 111, 11, 0, 0)#
dat[35,] <- c(3.05, 102, 1, 3858, 148, 175, 12, 0, 0)#
dat[36,] <- c(3.06, 198, 1, 4636, 197, 252, 15, 0, 0)#
dat[37,] <- c(3.07, 254, 1, 5883, 233, 352, 20, 1, 0)#
dat[38,] <- c(3.08, 350, 2, 7375, 366, 495, 22, 2, 0)#
dat[39,] <- c(3.09, 369, 2, 9172, 463, 643, 25, 5, 0)#
dat[40,] <- c(3.10, 480, 3, 10149, 631, 932, 31, 8, 0)#
dat[41,] <- c(3.11, 640, 4, 12462, 827, 1203, 38, 16, 0)#
dat[42,] <- c(3.12, 855, 6, 15113, 1016, 1598, 42, 17, 0)#
dat[42,] <- c(3.13, 1129, 7, 17660, 1266, 2160, 49, 30, 0)#
dat[43,] <- c(3.14, 1353, 12, 21157, 1441, 2820, 56, 41, 1)#
dat[44,] <- c(3.15, 2195, 14, 24747, 1809, 3497, 62, 45, 1)#
dat[45,] <- c(3.16, 2353, 21, 27980, 2158, 4372, 75, 51, 2)#
dat[46,] <- c(3.17, 2677, 27, 31506, 2503, 5656, 96, 67, 2)#
dat[47,] <- c(3.18, 3070, 31, 35713, 2978, 8074, 122, 77, 2)#
dat[48,] <- c(3.19, 3888, 41, 41035, 3405, 11980, 172, 94, 2)#
dat[49,] <- c(3.20, 5369, 53, 47021, 4032, 17438, 229, 114, 2)#
dat[50,] <- c(3.21, 6747, 53, 53578, 4825, 23710, 296, 152, 2)#
dat[51,] <- c(3.22, 7014, 98, 59138, 5476, 32341, 405, 219, 3)#
dat[52,] <- c(3.23, 8060, 115, 63927, 6077, 42749, 519, 254, 6)#
dat[53,] <- c(3.24, 8836, 128, 69176, 6820, 52685, 681, 290, 7)#
dat[54,] <- c(3.25, 9765, 153, 74386, 7503, 64916, 906, 391, 9)#
dat[55,] <- c(3.26, 10714, 188, 80589, 8215, 81964, 1159, 460, 13)#
dat[56,] <- c(3.27, 12161, 259, 86498, 9134, 100997, 1591, 604, 15)#
dat[57,] <- c(3.28, 13213, 275, 92472, 10023, 121105, 2039, 739, 17)#
dat[58,] <- c(3.29, 14336, 300, 97689, 10779, 140223, 2452, 890, 22)#
dat[59,] <- c(3.30, 15475, 359, 101739, 11591, 160686, 2985, 1020, 25)#
dat[60,] <- c(3.31, 16176, 433, 105792, 12428, 186082, 3806, 1250, 27)#
dat[61,] <- c(4.01, 17139, 488, 110574, 13155, 212747, 4745, 1484, 34)#
dat[62,] <- c(4.02, 18267, 536, 115242, 13915, 241626, 5821, 1706, 41)#
dat[63,] <- c(4.03, 19303, 607, 119827, 14681, 273808, 7007, 2012, 46)#
dat[64,] <- c(4.04, 20278, 666, 124632, 15362, 307876, 8359, 2407, 52)#
dat[65,] <- c(4.05, 21100, 715, 128948, 15887, 333593, 9534, 2637, 52)#
dat[66,] <- c(4.06, 21663, 802, 132547, 16523, 362955, 10748, 2878, 54)#
dat[67,] <- c(4.07, 22164, 856, 135586, 17127, 393707, 12674, 3333, 63)#
dat[68,] <- c(4.08, 23248, 909, 139422, 17669, 425746, 14610, 3645, 75)#
dat[69,] <- c(4.09, 24046, 909, 143626, 18279, 459989, 16466, 4042, 109)#
dat[70,] <- c(4.10, 24551, 999, 147577, 18849, 493567, 18544, 4509, 121)#
dat[71,] <- c(4.11, 25107, 1032, 152271, 19468, 525436, 20454, 5077, 130)#
dat[72,] <- c(4.12, 25415, 1106, 156363, 19899, 553493, 21936, 5274, 141)#
dat[73,] <- c(4.13, 25688, 1138, 159516, 20465, 578178, 23398, 5747, 149)#
dat[74,] <- c(4.14, 25936, 1175, 162488, 21067, 604165, 25776, 6171, 154)#
dat[75,] <- c(4.15, 26336, 1239, 165155, 21645, 633630, 28214, 6500, 195)#
dat[76,] <- c(4.16, 26732, 1281, 168941, 22170, 665706, 30355, 6889, 208)#
dat[77,] <- c(4.17, 27078, 1327, 172434, 22745, 696621, 32435, 7491, 231)#
dat[78,] <- c(4.18, 27404, 1368, 175925, 23227, 724895, 34178, 8053, 258)#
dat[79,] <- c(4.19, 27740, 1393, 178972, 23660, 751218, 35809, 8537, 277)#
dat[80,] <- c(4.20, 27693, 1429, 181228, 24114, 751218, 35809, 8990, 300)#
par(mfrow=c(4,1), mar=c(2.5,2.5,0.5,0.1))#
#______________________________________________________________##
# raw data#
#
# # plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#, ylim=c(0.1,max(dat$cases.italy)))#
# points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
# #______________________________________________________________##
# # pop size correction#
pop.factor <- 7.05#
pop.factor2 <- 38.1#
#
# plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), xlab="", ylab="")#
# points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.switz, col="red",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.switz, col="darkred",  type="o", pch=25, lwd=1.5)#
#
# points(1:length(dat$date), dat$cases.us/pop.factor2, col="blue",  type="o", pch=20, lwd=2)#
# points(1:length(dat$date), dat$deaths.us/pop.factor2, col="darkblue",  type="o", pch=25, lwd=1.5)#
#
# legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
# #______________________________________________________________##
# # time and pop size correction#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0,max(dat$cases.switz)), xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-10), (dat$cases.us/pop.factor2)[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), (dat$deaths.us/pop.factor2)[-c(1:10)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#
plot(1:length(dat$date), dat$cases.italy/pop.factor, col="white", xlim=c(20, length(dat[,1])), ylim=c(0.9,max(dat$cases.switz)), xlab="", ylab="", log="y")#
points(1:length(dat$date), dat$cases.italy/pop.factor, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy/pop.factor, col="darkgreen",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-6), dat$cases.switz[-c(1:6)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-6), dat$deaths.switz[-c(1:6)], col="darkred",  type="o", pch=25, lwd=1.5)#
#
points(1:(length(dat$date)-15), (dat$cases.us/pop.factor2)[-c(1:15)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-15), (dat$deaths.us/pop.factor2)[-c(1:15)], col="darkblue",  type="o", pch=25, lwd=1.5)#
legend("topleft", c("Italy", "Switzerland", "US", "Cases", "Deaths"), pch=c(15,15,15,20,25), col=c("green3", "red2", "blue", "black", "black"))#
#______________________________________________________________##
# time correction only#
#
par(mfrow=c(1,2))#
#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)))#, log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))#
plot(1:length(dat$date), dat$cases.italy, col="white", xlim=c(14, length(dat[,1])), ylim=c(0.9,max(dat)), log="y", xlab="", ylab="")#
points(1:length(dat$date), dat$cases.italy, col="green3",  type="o", pch=20, lwd=2)#
points(1:length(dat$date), dat$deaths.italy, col="green3",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-11), dat$cases.switz[-c(1:11)], col="red",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-11), dat$deaths.switz[-c(1:11)], col="red",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-10), dat$cases.us[-c(1:10)], col="blue",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-10), dat$deaths.us[-c(1:10)], col="blue",  type="o", pch=25, lwd=1)#
#
points(1:(length(dat$date)-22), dat$cases.va[-c(1:22)], col="orange",  type="o", pch=20, lwd=2)#
points(1:(length(dat$date)-22), dat$deaths.va[-c(1:22)], col="orange",  type="o", pch=25, lwd=1)#
#
legend("topleft", c("Italy", "Switzerland", "US", "Virginia", "Cases", "Deaths"), pch=c(15,15,15,15,20,25), col=c("green3", "red2", "blue", "orange", "black", "black"))
setwd("~/Documents/UNIL/PartitioningMethods_SimulationProject/FunctioningPipeline/AnalysisResults")#
make.merge.id <- function(dat){#
	id.col <- rep(NA, dim(dat)[1])#
	for(i in 1:dim(dat)[1]){#
		if(length(grep("lopho", dat$file[i])) > 0) spp <- "lopho_"#
		if(length(grep("myria", dat$file[i])) > 0) spp <- "myria_"#
		if(length(grep("10", dat$file[i])) > 0) samp <- "10_"#
		if(length(grep("20", dat$file[i])) > 0) samp <- "20_"#
		if(length(grep("40", dat$file[i])) > 0) samp <- "40_"#
		if(length(grep("80", dat$file[i])) > 0) samp <- "80_"#
		if(length(grep("rcluster", dat$file[i])) > 0) algo <- "rcluster_"#
		if(length(grep("greedy", dat$file[i])) > 0) algo <- "greedy_"#
		if(length(grep("noPart", dat$file[i])) > 0) algo <- "noPart_"#
		if(length(grep("AIC", dat$file[i])) > 0) crit <- "AIC"#
		if(length(grep("AICc", dat$file[i])) > 0) crit <- "AICc"#
		if(length(grep("BIC", dat$file[i])) > 0) crit <- "BIC"#
		if(length(grep("noPart", dat$file[i])) > 0) crit <- "noPart"#
		id.col[i] <- paste(c(spp, samp, algo, crit), collapse="")#
	}#
	return(id.col)#
}#
make.merge.id2 <- function(dat){#
	id.col <- rep(NA, dim(dat)[1])#
	for(i in 1:dim(dat)[1]){#
		if(length(grep("lopho", dat$file[i])) > 0) spp <- "lopho_"#
		if(length(grep("myria", dat$file[i])) > 0) spp <- "myria_"#
		if(length(grep("10", dat$file[i])) > 0) samp <- "10_"#
		if(length(grep("20", dat$file[i])) > 0) samp <- "20_"#
		if(length(grep("40", dat$file[i])) > 0) samp <- "40_"#
		if(length(grep("80", dat$file[i])) > 0) samp <- "80_"#
		if(length(grep("r-", dat$file[i])) > 0) algo <- "rcluster_"#
		if(length(grep("greedy", dat$file[i])) > 0) algo <- "greedy_"#
		if(length(grep("noPart", dat$file[i])) > 0) algo <- "noPart_"#
		if(length(grep("-a", dat$file[i])) > 0) crit <- "AIC"#
		if(length(grep("-c", dat$file[i])) > 0) crit <- "AICc"#
		if(length(grep("-b", dat$file[i])) > 0) crit <- "BIC"#
		if(length(grep("noPart", dat$file[i])) > 0) crit <- "noPart"#
		id.col[i] <- paste(c(spp, samp, algo, crit), collapse="")#
	}#
	return(id.col)#
}#
get.rep.difference <- function(dat, rep, samp.size, spp, partitioning.criterion, distance){#
	temp.dat <- dat[dat$replicate == rep & dat$samp.size == samp.size & dat$species == spp , ]#
	no.part.result <- temp.dat[temp.dat$search.algo == "noPart" ,]#
	rclust.AIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AIC",]#
	rclust.BIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "BIC",]#
	rclust.AICc.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AICc",]#
	if(partitioning.criterion == "AIC"){#
		num.partitions.inferred <- rclust.AIC.result$num.partitions#
		if(dim(rclust.AIC.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.AIC.result[distance] }#
		part.dist <- rclust.AIC.result[distance]#
	}#
	if(partitioning.criterion == "BIC"){#
		num.partitions.inferred <- rclust.BIC.result$num.partitions#
		if(dim(rclust.BIC.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.BIC.result[distance] }#
		part.dist <- rclust.BIC.result[distance]#
	}#
	if(partitioning.criterion == "AICc"){#
		num.partitions.inferred <- rclust.AICc.result$num.partitions#
		if(dim(rclust.AICc.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.AICc.result[distance] }#
		part.dist <- rclust.AICc.result[distance]#
	}#
	return(c(no.part.result[distance], part.dist, as.numeric(difference), num.partitions.inferred))		#
}#
#
#####################################
#
get.boxplot.dat <- function(dat, samp.size, spp, partitioning.criterion, distance){	#
	samp.size.dists <- data.frame(matrix(NA, ncol=4))#
	names(samp.size.dists) <- c("no.part.raw", "part.raw", "distance", "num.parts")#
	for(j in unique(dat$replicate)){#
		result <- get.rep.difference(dat, rep=j, samp.size=samp.size, spp=spp, partitioning.criterion=partitioning.criterion, distance=distance)#
		#dist <- result[3]#
		#parts <- result[4]#
		samp.size.dists[j,] <- c(result[1], result[2], result[3], result[4])#
	}#
	return(samp.size.dists)#
}#
get.partition.dat <- function(dat, samp.size, spp, partitioning.criterion){	#
	partition.numbers <- NULL#
	for(j in unique(dat$replicate)){#
		temp.dat <- dat[dat$replicate == j & dat$samp.size == samp.size & dat$species == spp , ]#
		rclust.AIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AIC" ,]#
		rclust.BIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "BIC" ,]#
		rclust.AICc.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AICc",]#
		if(partitioning.criterion == "AIC"){#
			if(length(rclust.AIC.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.AIC.result$num.partitions }#
		}#
		if(partitioning.criterion == "BIC"){#
			if(length(rclust.BIC.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.BIC.result$num.partitions }#
		}#
		if(partitioning.criterion == "AICc"){#
			if(length(rclust.AICc.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.AICc.result$num.partitions }#
		}#
		partition.numbers <- c(partition.numbers, num.parts)#
	}#
	return(partition.numbers)#
}#
#
#####################################
# mut rate 1000#
#
infiles.a <- c("AllStatsOutput_New_Rep1_100-1000.csv",#
				"AllStatsOutput_New_Rep2_100-1000.csv",#
				"AllStatsOutput_New_Rep3_100-1000.csv",#
				"AllStatsOutput_New_Rep4_100-1000.csv",#
				"AllStatsOutput_New_Rep5_100-1000.csv",#
				"AllStatsOutput_New_Rep6_100-1000.csv",#
				"AllStatsOutput_Newest_Rep7_100-1000.csv",#
				"AllStatsOutput_Newest_Rep8_100-1000.csv",#
				"AllStatsOutput_Newest_Rep9_100-1000.csv",#
				"AllStatsOutput_Newest_Rep10_100-1000.csv",#
				"AllStatsOutput_Newest_Rep11_100-1000.csv",#
				"AllStatsOutput_Newest_Rep12_100-1000.csv",#
				"AllStatsOutput_Newest_Rep13_100-1000.csv",#
				"AllStatsOutput_Newest_Rep14_100-1000.csv",#
				"AllStatsOutput_Newest_Rep15_100-1000.csv",#
				"AllStatsOutput_Newest_Rep16_100-1000.csv",#
				"AllStatsOutput_Newest_Rep17_100-1000.csv",#
				"AllStatsOutput_Newest_Rep18_100-1000.csv",#
				"AllStatsOutput_Newest_Rep19_100-1000.csv",#
				"AllStatsOutput_Newest_Rep20_100-1000.csv",#
				"AllStatsOutput_Newest_Rep21_100-1000.csv",#
				"AllStatsOutput_Newest_Rep22_100-1000.csv",#
				"AllStatsOutput_Newest_Rep23_100-1000.csv",#
				"AllStatsOutput_Newest_Rep24_100-1000.csv",#
				"AllStatsOutput_Newest_Rep25_100-1000.csv",#
				"AllStatsOutput_Newest_Rep26_100-1000.csv",#
				"AllStatsOutput_Newest_Rep27_100-1000.csv",#
				"AllStatsOutput_Newest_Rep28_100-1000.csv",#
				"AllStatsOutput_Newest_Rep29_100-1000.csv",#
				"AllStatsOutput_Newest_Rep30_100-1000.csv",#
				"AllStatsOutput_Newest_Rep31_100-1000.csv",#
				"AllStatsOutput_Newest_Rep32_100-1000.csv",#
				"AllStatsOutput_Newest_Rep33_100-1000.csv",#
				"AllStatsOutput_Newest_Rep34_100-1000.csv",#
				"AllStatsOutput_Newest_Rep35_100-1000.csv"#
				)#
infiles.a2 <- c(	"AllStatsOutput_Rep1.csv",#
				"AllStatsOutput_Rep2.csv",#
				"AllStatsOutput_Rep3.csv",#
				"AllStatsOutput_Rep4.csv",#
				"AllStatsOutput_Rep5.csv",#
				"AllStatsOutput_Rep6.csv",#
				"AllStatsOutput_Rep7.csv",#
				"AllStatsOutput_Rep8.csv",#
				"AllStatsOutput_Rep9.csv",#
				"AllStatsOutput_Rep10.csv"#
				)#
# IQtree results#
infiles.b <- c("RF_Eucl_results_New_Rep1_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep2_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep3_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep4_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep5_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep6_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep7_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep8_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep9_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep10_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep11_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep12_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep13_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep14_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep15_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep16_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep17_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep18_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep19_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep20_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep21_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep22_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep23_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep24_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep25_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep26_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep27_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep28_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep29_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep30_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep31_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep32_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep33_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep34_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep35_100-1000_wConsensus.txt"#
				)#
infiles.b2 <- c(	"RF_Eucl_results_N10_Rep1_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep2_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep3_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep4_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep5_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep6_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep7_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep8_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep9_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep10_wConsensus.txt"#
				)#
## RAxML results#
infiles.c <- c("RF_Eucl_results_New_Rep1_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep2_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep3_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep4_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep5_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep6_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep7_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep8_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep9_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep10_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep11_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep12_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep13_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep14_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep15_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep16_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep17_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep18_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep19_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep20_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep21_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep22_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep23_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep24_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep25_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep26_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep27_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep28_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep29_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep30_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep31_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep32_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep33_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep34_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep35_100-1000_RAxML.txt"#
				)#
infiles.c2 <- c("RF_Eucl_results_N10_Rep1_RAxML.txt",#
				"RF_Eucl_results_N10_Rep2_RAxML.txt",#
				"RF_Eucl_results_N10_Rep3_RAxML.txt",#
				"RF_Eucl_results_N10_Rep4_RAxML.txt",#
				"RF_Eucl_results_N10_Rep5_RAxML.txt",#
				"RF_Eucl_results_N10_Rep6_RAxML.txt",#
				"RF_Eucl_results_N10_Rep7_RAxML.txt",#
				"RF_Eucl_results_N10_Rep8_RAxML.txt",#
				"RF_Eucl_results_N10_Rep9_RAxML.txt",#
				"RF_Eucl_results_N10_Rep10_RAxML.txt"#
				)#
dat <- NULL#
for(i in c(1:length(infiles.a))){ #**************UNCOMMENT ME FOR ALL REPS#
	temp.dat1 <- read.csv(infiles.a[i], header=TRUE, stringsAsFactors=FALSE)#
	temp.dat1$uniqueID <- paste(temp.dat1$species, temp.dat1$samp.size, temp.dat1$search.algo, temp.dat1$part.IC, sep="_")#
	temp.dat2 <- read.table(infiles.b[i], header=TRUE, stringsAsFactors=FALSE)#
	# because also have consenseus trees now:#
	temp.dat2 <- cbind(temp.dat2[1:32,], temp.dat2[33:64, 2:3])#
	names(temp.dat2) <- c("filename", "rf_dist", "eucl_dist", "cons_rf_dist", "cons_eucl_dist")#
	temp.dat2$uniqueID <- make.merge.id(temp.dat2)#
	temp.dat3 <- read.table(infiles.c[i], header=TRUE, stringsAsFactors=FALSE)#
	names(temp.dat3) <- c("filename_raxml", "rf_dist_raxml", "eucl_dist_raxml")#
	temp.dat3$uniqueID <- make.merge.id2(temp.dat3)#
	temp.temp.dat <- merge(temp.dat1, temp.dat2, by="uniqueID")#
	temp.dat <- merge(temp.temp.dat, temp.dat3, by="uniqueID")#
	temp.dat$gene.size <- 100#
	temp.dat$mut.rate <- 1000#
	temp.dat$replicate <- i#
#
	dat <- rbind(dat, temp.dat)#
}#
#
# additional 10 reps at only 10 species and all else same, plus 10 species with rate variation and no indel model#
dat2 <- NULL#
for(i in c(1:length(infiles.a2))){ #**************UNCOMMENT ME FOR ALL REPS#
	temp.dat1 <- read.csv(infiles.a2[i], header=TRUE, stringsAsFactors=FALSE)#
	temp.dat1$uniqueID <- paste(temp.dat1$species, temp.dat1$samp.size, temp.dat1$search.algo, temp.dat1$part.IC, sep="_")#
	temp.dat2 <- read.table(infiles.b2[i], header=TRUE, stringsAsFactors=FALSE)#
	# because also have consenseus trees now:#
	temp.dat2 <- cbind(temp.dat2[1:32,], temp.dat2[33:64, 2:3])#
	names(temp.dat2) <- c("filename", "rf_dist", "eucl_dist", "cons_rf_dist", "cons_eucl_dist")#
	temp.dat2$uniqueID <- make.merge.id(temp.dat2)#
	temp.dat3 <- read.table(infiles.c2[i], header=TRUE, stringsAsFactors=FALSE)#
	names(temp.dat3) <- c("filename_raxml", "rf_dist_raxml", "eucl_dist_raxml")#
	temp.dat3$uniqueID <- make.merge.id2(temp.dat3)#
	temp.temp.dat <- merge(temp.dat1, temp.dat2, by="uniqueID")#
	temp.dat <- merge(temp.temp.dat, temp.dat3, by="uniqueID")#
	temp.dat$gene.size <- 100#
	temp.dat$mut.rate <- 1000#
	temp.dat$replicate <- i#
	dat2 <- rbind(dat2, temp.dat)#
}#
dat2$uniqueID <- gsub('lopho','TenSpp', dat2$uniqueID)#
dat2$uniqueID <- gsub('myria','RateVar', dat2$uniqueID)#
dat2$species <- gsub('lopho','TenSpp', dat2$species)#
dat2$species <- gsub('myria','RateVar', dat2$species)#
#
dat <- rbind(dat, dat2)#
#
no.part.dat <- dat[dat$part.IC == "noPart" ,]#
#####################################
#
plot.function <- function(dat, dataset, tree.distance, x.spot.adjustment, p.height, p.height.factor){#
	if(dataset == "lopho"){#
#		text(x=0.3, y=p.height+p.height.factor, "n=", cex=text.size)#
		text(x=0.3, y=p.height, "p =", cex=text.size)#
	}#
	for(i in 1:4){#
		x.spot <- i + x.spot.adjustment#
		plot.dat <- get.boxplot.dat(dat=dat, samp.size=samp.sizes[i], spp=dataset, partitioning.criterion=part.crit, distance=tree.distance)#
		boxplot(plot.dat$distance, add=TRUE, at=x.spot, pch=23, col=samp.size.col[i], border=outline.col, boxwex=box.width, lty=line.type, lwd=line.width, axes=FALSE)#
#		text(x=x.spot, y=p.height+p.height.factor, paste(dim(plot.dat)[1]), cex=text.size, srt=45)#
		text(x=x.spot, y=p.height, format(as.numeric(wilcox.test(plot.dat$no.part.raw, plot.dat$part.raw, paired=TRUE, alternative="two.sided")$p.value), digits=2), cex=text.size, srt=45)#
	}#
}#
#####################################
#####################################
samp.size.col <- c("steelblue4", "darkorange2", "green4", "red3")#
opac <- 0.75#
outline.col <- "gray30"#
samp.sizes <- c(10,20,40,80)#
#####################################
ylim1 <- c(-0.225, 0.25)#
#ylim1 <- c(-0.1, 0.1)#
box.width <- 1.5#
line.type <- 1#
line.width <- 1.5#
ytext1 <- 0.15#
p.height1 <- 0.25#
p.height.factor1=0.04#
text.size <- 0.85#
#criteria <- c("AIC", "BIC", "AICc")#
#for(criterion in criteria){#
criterion <- "BIC"#
if(criterion == "AIC") stat.data.set <- stat.data.set.AIC#
if(criterion == "BIC") stat.data.set <- stat.data.set.BIC#
if(criterion == "AICc") stat.data.set <- stat.data.set.AICc#
part.crit <- criterion#
#
pdf(paste(c("Results_Plots/Boxplots_RAxML_", part.crit, "_StatsParts_onlyRFdist.pdf"), collapse=""), width=8, height=4)#
par(mar=c(2.5,1.95,1.75,0.25))#, mfrow=c(1,2))#
layout(matrix(c(1,2,2,2,2,2,2,2,3,3,3,3,3,3,3), nrow=1))#
#
#_________________________________________________________________________________________________________##
#
#plot(0, type="n", xlim=c(0.4,8.75), ylim=ylim1, xlab="", axes=FALSE, ylab="Difference in normalized Robinson Foulds distance from true tree", mgp=c(3,0.9,0))#
plot(0, type="n", axes=FALSE, xlab="", ylab="")#
mtext(side=2, "Difference in normalized Robinson Foulds distance from true tree", cex=0.79, line=-0.3)#
mtext(side=2, "(no partitioning - partitioning)", cex=0.75, line=-1.6)#
#plot(0, type="n", xlim=c(0.4,8.75), ylim=ylim1, xlab="", xaxt="n", ylab="Difference in normalized Robinson Foulds distance from true tree", main="IQtree", mgp=c(3,0.9,0))#
#
plot(0, type="n", xlim=c(0.4,8.75), ylim=ylim1, xlab="", xaxt="n", ylab="", main="IQTREE_PartitionFinder", mgp=c(3,0.9,0))#
#
axis(side=1, at=c(2.5, 7), c("62 species simulated", "25 species simulated"))#
#mtext(side=2, "(no partitioning - partitioning)", cex=0.75, line=2)#
abline(h=0, col="gray75", lty=3, lwd=1.5)#
#
# lopho (62 spp)#
plot.function(dat, dataset="lopho", tree.distance="rf_dist", x.spot.adjustment=0, p.height=p.height1, p.height.factor=p.height.factor1)#
#
# myria (25 spp)#
plot.function(dat, dataset="myria", tree.distance="rf_dist", x.spot.adjustment=4.5, p.height=p.height1, p.height.factor=p.height.factor1)#
points(7.4, p.height1-0.025, pch="*", cex=2.5, col="green4")#
#
legend("bottomright", c("10", "20", "40", "80"), pch=15, col=samp.size.col, title = "num. genes", cex=0.875, pt.cex=1.5) # , bg="white"#
# RAxML RF distance#
plot(0, type="n", xlim=c(0.4,8.75), ylim=ylim1, xlab="", xaxt="n", ylab="", main="RAxML_PartitionFinder", mgp=c(3,0.9,0))#
axis(side=1, at=c(2.5, 7), c("62 species simulated", "25 species simulated"))#
abline(h=0, col="gray75", lty=3, lwd=1.5)#
text(3,ytext1, expression(italic("partitioning better")), cex=1, col="green4")#
text(3,-ytext1, expression(italic("no partitioning better")), cex=1, col="red3")#
#
# lopho (62 spp)#
plot.function(dat, dataset="lopho", tree.distance="rf_dist_raxml", x.spot.adjustment=0, p.height=p.height1, p.height.factor=p.height.factor1)#
#
# myria (25 spp)#
plot.function(dat, dataset="myria", tree.distance="rf_dist_raxml", x.spot.adjustment=4.5, p.height=p.height1, p.height.factor=p.height.factor1)#
dev.off()
setwd("~/Documents/UNIL/PartitioningMethods_SimulationProject/FunctioningPipeline/AnalysisResults")#
make.merge.id <- function(dat){#
	id.col <- rep(NA, dim(dat)[1])#
	for(i in 1:dim(dat)[1]){#
		if(length(grep("lopho", dat$file[i])) > 0) spp <- "lopho_"#
		if(length(grep("myria", dat$file[i])) > 0) spp <- "myria_"#
		if(length(grep("10", dat$file[i])) > 0) samp <- "10_"#
		if(length(grep("20", dat$file[i])) > 0) samp <- "20_"#
		if(length(grep("40", dat$file[i])) > 0) samp <- "40_"#
		if(length(grep("80", dat$file[i])) > 0) samp <- "80_"#
		if(length(grep("rcluster", dat$file[i])) > 0) algo <- "rcluster_"#
		if(length(grep("greedy", dat$file[i])) > 0) algo <- "greedy_"#
		if(length(grep("noPart", dat$file[i])) > 0) algo <- "noPart_"#
		if(length(grep("AIC", dat$file[i])) > 0) crit <- "AIC"#
		if(length(grep("AICc", dat$file[i])) > 0) crit <- "AICc"#
		if(length(grep("BIC", dat$file[i])) > 0) crit <- "BIC"#
		if(length(grep("noPart", dat$file[i])) > 0) crit <- "noPart"#
		id.col[i] <- paste(c(spp, samp, algo, crit), collapse="")#
	}#
	return(id.col)#
}#
make.merge.id2 <- function(dat){#
	id.col <- rep(NA, dim(dat)[1])#
	for(i in 1:dim(dat)[1]){#
		if(length(grep("lopho", dat$file[i])) > 0) spp <- "lopho_"#
		if(length(grep("myria", dat$file[i])) > 0) spp <- "myria_"#
		if(length(grep("10", dat$file[i])) > 0) samp <- "10_"#
		if(length(grep("20", dat$file[i])) > 0) samp <- "20_"#
		if(length(grep("40", dat$file[i])) > 0) samp <- "40_"#
		if(length(grep("80", dat$file[i])) > 0) samp <- "80_"#
		if(length(grep("r-", dat$file[i])) > 0) algo <- "rcluster_"#
		if(length(grep("greedy", dat$file[i])) > 0) algo <- "greedy_"#
		if(length(grep("noPart", dat$file[i])) > 0) algo <- "noPart_"#
		if(length(grep("-a", dat$file[i])) > 0) crit <- "AIC"#
		if(length(grep("-c", dat$file[i])) > 0) crit <- "AICc"#
		if(length(grep("-b", dat$file[i])) > 0) crit <- "BIC"#
		if(length(grep("noPart", dat$file[i])) > 0) crit <- "noPart"#
		id.col[i] <- paste(c(spp, samp, algo, crit), collapse="")#
	}#
	return(id.col)#
}#
get.rep.difference <- function(dat, rep, samp.size, spp, partitioning.criterion, distance){#
	temp.dat <- dat[dat$replicate == rep & dat$samp.size == samp.size & dat$species == spp , ]#
	no.part.result <- temp.dat[temp.dat$search.algo == "noPart" ,]#
	rclust.AIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AIC",]#
	rclust.BIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "BIC",]#
	rclust.AICc.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AICc",]#
	if(partitioning.criterion == "AIC"){#
		num.partitions.inferred <- rclust.AIC.result$num.partitions#
		if(dim(rclust.AIC.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.AIC.result[distance] }#
		part.dist <- rclust.AIC.result[distance]#
	}#
	if(partitioning.criterion == "BIC"){#
		num.partitions.inferred <- rclust.BIC.result$num.partitions#
		if(dim(rclust.BIC.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.BIC.result[distance] }#
		part.dist <- rclust.BIC.result[distance]#
	}#
	if(partitioning.criterion == "AICc"){#
		num.partitions.inferred <- rclust.AICc.result$num.partitions#
		if(dim(rclust.AICc.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.AICc.result[distance] }#
		part.dist <- rclust.AICc.result[distance]#
	}#
	return(c(no.part.result[distance], part.dist, as.numeric(difference), num.partitions.inferred))		#
}#
#
#####################################
#
get.boxplot.dat <- function(dat, samp.size, spp, partitioning.criterion, distance){	#
	samp.size.dists <- data.frame(matrix(NA, ncol=4))#
	names(samp.size.dists) <- c("no.part.raw", "part.raw", "distance", "num.parts")#
	for(j in unique(dat$replicate)){#
		result <- get.rep.difference(dat, rep=j, samp.size=samp.size, spp=spp, partitioning.criterion=partitioning.criterion, distance=distance)#
		#dist <- result[3]#
		#parts <- result[4]#
		samp.size.dists[j,] <- c(result[1], result[2], result[3], result[4])#
	}#
	return(samp.size.dists)#
}#
get.partition.dat <- function(dat, samp.size, spp, partitioning.criterion){	#
	partition.numbers <- NULL#
	for(j in unique(dat$replicate)){#
		temp.dat <- dat[dat$replicate == j & dat$samp.size == samp.size & dat$species == spp , ]#
		rclust.AIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AIC" ,]#
		rclust.BIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "BIC" ,]#
		rclust.AICc.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AICc",]#
		if(partitioning.criterion == "AIC"){#
			if(length(rclust.AIC.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.AIC.result$num.partitions }#
		}#
		if(partitioning.criterion == "BIC"){#
			if(length(rclust.BIC.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.BIC.result$num.partitions }#
		}#
		if(partitioning.criterion == "AICc"){#
			if(length(rclust.AICc.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.AICc.result$num.partitions }#
		}#
		partition.numbers <- c(partition.numbers, num.parts)#
	}#
	return(partition.numbers)#
}#
#
#####################################
# mut rate 1000#
#
infiles.a <- c("AllStatsOutput_New_Rep1_100-1000.csv",#
				"AllStatsOutput_New_Rep2_100-1000.csv",#
				"AllStatsOutput_New_Rep3_100-1000.csv",#
				"AllStatsOutput_New_Rep4_100-1000.csv",#
				"AllStatsOutput_New_Rep5_100-1000.csv",#
				"AllStatsOutput_New_Rep6_100-1000.csv",#
				"AllStatsOutput_Newest_Rep7_100-1000.csv",#
				"AllStatsOutput_Newest_Rep8_100-1000.csv",#
				"AllStatsOutput_Newest_Rep9_100-1000.csv",#
				"AllStatsOutput_Newest_Rep10_100-1000.csv",#
				"AllStatsOutput_Newest_Rep11_100-1000.csv",#
				"AllStatsOutput_Newest_Rep12_100-1000.csv",#
				"AllStatsOutput_Newest_Rep13_100-1000.csv",#
				"AllStatsOutput_Newest_Rep14_100-1000.csv",#
				"AllStatsOutput_Newest_Rep15_100-1000.csv",#
				"AllStatsOutput_Newest_Rep16_100-1000.csv",#
				"AllStatsOutput_Newest_Rep17_100-1000.csv",#
				"AllStatsOutput_Newest_Rep18_100-1000.csv",#
				"AllStatsOutput_Newest_Rep19_100-1000.csv",#
				"AllStatsOutput_Newest_Rep20_100-1000.csv",#
				"AllStatsOutput_Newest_Rep21_100-1000.csv",#
				"AllStatsOutput_Newest_Rep22_100-1000.csv",#
				"AllStatsOutput_Newest_Rep23_100-1000.csv",#
				"AllStatsOutput_Newest_Rep24_100-1000.csv",#
				"AllStatsOutput_Newest_Rep25_100-1000.csv",#
				"AllStatsOutput_Newest_Rep26_100-1000.csv",#
				"AllStatsOutput_Newest_Rep27_100-1000.csv",#
				"AllStatsOutput_Newest_Rep28_100-1000.csv",#
				"AllStatsOutput_Newest_Rep29_100-1000.csv",#
				"AllStatsOutput_Newest_Rep30_100-1000.csv",#
				"AllStatsOutput_Newest_Rep31_100-1000.csv",#
				"AllStatsOutput_Newest_Rep32_100-1000.csv",#
				"AllStatsOutput_Newest_Rep33_100-1000.csv",#
				"AllStatsOutput_Newest_Rep34_100-1000.csv",#
				"AllStatsOutput_Newest_Rep35_100-1000.csv"#
				)#
infiles.a2 <- c(	"AllStatsOutput_Rep1.csv",#
				"AllStatsOutput_Rep2.csv",#
				"AllStatsOutput_Rep3.csv",#
				"AllStatsOutput_Rep4.csv",#
				"AllStatsOutput_Rep5.csv",#
				"AllStatsOutput_Rep6.csv",#
				"AllStatsOutput_Rep7.csv",#
				"AllStatsOutput_Rep8.csv",#
				"AllStatsOutput_Rep9.csv",#
				"AllStatsOutput_Rep10.csv"#
				)#
# IQtree results#
infiles.b <- c("RF_Eucl_results_New_Rep1_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep2_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep3_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep4_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep5_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep6_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep7_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep8_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep9_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep10_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep11_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep12_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep13_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep14_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep15_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep16_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep17_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep18_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep19_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep20_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep21_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep22_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep23_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep24_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep25_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep26_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep27_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep28_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep29_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep30_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep31_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep32_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep33_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep34_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep35_100-1000_wConsensus.txt"#
				)#
infiles.b2 <- c(	"RF_Eucl_results_N10_Rep1_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep2_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep3_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep4_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep5_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep6_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep7_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep8_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep9_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep10_wConsensus.txt"#
				)#
## RAxML results#
infiles.c <- c("RF_Eucl_results_New_Rep1_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep2_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep3_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep4_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep5_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep6_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep7_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep8_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep9_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep10_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep11_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep12_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep13_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep14_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep15_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep16_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep17_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep18_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep19_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep20_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep21_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep22_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep23_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep24_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep25_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep26_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep27_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep28_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep29_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep30_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep31_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep32_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep33_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep34_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep35_100-1000_RAxML.txt"#
				)#
infiles.c2 <- c("RF_Eucl_results_N10_Rep1_RAxML.txt",#
				"RF_Eucl_results_N10_Rep2_RAxML.txt",#
				"RF_Eucl_results_N10_Rep3_RAxML.txt",#
				"RF_Eucl_results_N10_Rep4_RAxML.txt",#
				"RF_Eucl_results_N10_Rep5_RAxML.txt",#
				"RF_Eucl_results_N10_Rep6_RAxML.txt",#
				"RF_Eucl_results_N10_Rep7_RAxML.txt",#
				"RF_Eucl_results_N10_Rep8_RAxML.txt",#
				"RF_Eucl_results_N10_Rep9_RAxML.txt",#
				"RF_Eucl_results_N10_Rep10_RAxML.txt"#
				)#
dat <- NULL#
for(i in c(1:length(infiles.a))){ #**************UNCOMMENT ME FOR ALL REPS#
	temp.dat1 <- read.csv(infiles.a[i], header=TRUE, stringsAsFactors=FALSE)#
	temp.dat1$uniqueID <- paste(temp.dat1$species, temp.dat1$samp.size, temp.dat1$search.algo, temp.dat1$part.IC, sep="_")#
	temp.dat2 <- read.table(infiles.b[i], header=TRUE, stringsAsFactors=FALSE)#
	# because also have consenseus trees now:#
	temp.dat2 <- cbind(temp.dat2[1:32,], temp.dat2[33:64, 2:3])#
	names(temp.dat2) <- c("filename", "rf_dist", "eucl_dist", "cons_rf_dist", "cons_eucl_dist")#
	temp.dat2$uniqueID <- make.merge.id(temp.dat2)#
	temp.dat3 <- read.table(infiles.c[i], header=TRUE, stringsAsFactors=FALSE)#
	names(temp.dat3) <- c("filename_raxml", "rf_dist_raxml", "eucl_dist_raxml")#
	temp.dat3$uniqueID <- make.merge.id2(temp.dat3)#
	temp.temp.dat <- merge(temp.dat1, temp.dat2, by="uniqueID")#
	temp.dat <- merge(temp.temp.dat, temp.dat3, by="uniqueID")#
	temp.dat$gene.size <- 100#
	temp.dat$mut.rate <- 1000#
	temp.dat$replicate <- i#
#
	dat <- rbind(dat, temp.dat)#
}#
#
# additional 10 reps at only 10 species and all else same, plus 10 species with rate variation and no indel model#
dat2 <- NULL#
for(i in c(1:length(infiles.a2))){ #**************UNCOMMENT ME FOR ALL REPS#
	temp.dat1 <- read.csv(infiles.a2[i], header=TRUE, stringsAsFactors=FALSE)#
	temp.dat1$uniqueID <- paste(temp.dat1$species, temp.dat1$samp.size, temp.dat1$search.algo, temp.dat1$part.IC, sep="_")#
	temp.dat2 <- read.table(infiles.b2[i], header=TRUE, stringsAsFactors=FALSE)#
	# because also have consenseus trees now:#
	temp.dat2 <- cbind(temp.dat2[1:32,], temp.dat2[33:64, 2:3])#
	names(temp.dat2) <- c("filename", "rf_dist", "eucl_dist", "cons_rf_dist", "cons_eucl_dist")#
	temp.dat2$uniqueID <- make.merge.id(temp.dat2)#
	temp.dat3 <- read.table(infiles.c2[i], header=TRUE, stringsAsFactors=FALSE)#
	names(temp.dat3) <- c("filename_raxml", "rf_dist_raxml", "eucl_dist_raxml")#
	temp.dat3$uniqueID <- make.merge.id2(temp.dat3)#
	temp.temp.dat <- merge(temp.dat1, temp.dat2, by="uniqueID")#
	temp.dat <- merge(temp.temp.dat, temp.dat3, by="uniqueID")#
	temp.dat$gene.size <- 100#
	temp.dat$mut.rate <- 1000#
	temp.dat$replicate <- i#
	dat2 <- rbind(dat2, temp.dat)#
}#
dat2$uniqueID <- gsub('lopho','TenSpp', dat2$uniqueID)#
dat2$uniqueID <- gsub('myria','RateVar', dat2$uniqueID)#
dat2$species <- gsub('lopho','TenSpp', dat2$species)#
dat2$species <- gsub('myria','RateVar', dat2$species)#
#
dat <- rbind(dat, dat2)#
#
no.part.dat <- dat[dat$part.IC == "noPart" ,]#
#####################################
#
plot.function <- function(dat, dataset, tree.distance, x.spot.adjustment, p.height, p.height.factor){#
	if(dataset == "lopho"){#
		text(x=0.3, y=p.height+p.height.factor, "n=", cex=text.size)#
		text(x=0.3, y=p.height, "p=", cex=text.size)#
	}#
	for(i in 1:4){#
		x.spot1 <- i + x.spot.adjustment - 0.2#
		x.spot2 <- i + x.spot.adjustment + 0.2#
		plot.dat <- get.boxplot.dat(dat=dat, samp.size=samp.sizes[i], spp=dataset, partitioning.criterion=part.crit, distance=tree.distance)#
		one.partition.dat <- plot.dat[plot.dat$num.parts == 1 ,]#
		more.partitions.dat <- plot.dat[plot.dat$num.parts > 1 ,]#
		if(dim(one.partition.dat)[1] > 0){#
			 boxplot(one.partition.dat$distance, add=TRUE, at=x.spot1, pch=23, col=alpha(samp.size.col[i], opac), border=alpha(outline.col, opac), boxwex=box.width, lty=line.type, lwd=line.width, axes=FALSE)#
		}else{#
			#points(x.spot1, p.height, col="gray90", pch=15, cex=3)#
		}#
		if(dim(more.partitions.dat)[1] > 0){#
			boxplot(more.partitions.dat$distance, add=TRUE, at=x.spot2, pch=23, col=samp.size.col[i], border=outline.col, boxwex=box.width, lty=line.type, lwd=line.width, axes=FALSE)#
		}else{#
			##
		}#
		text(x=x.spot1, y=p.height+p.height.factor, paste(dim(one.partition.dat)[1]), cex=text.size, srt=45)#
		text(x=x.spot2, y=p.height+p.height.factor, paste(dim(more.partitions.dat)[1]), cex=text.size, srt=45)#
		if(dim(one.partition.dat)[1] > 0){#
			text(x=x.spot1, y=p.height, format(as.numeric(wilcox.test(one.partition.dat$no.part.raw, one.partition.dat$part.raw, paired=TRUE, alternative="two.sided")$p.value), digits=2), cex=text.size, srt=45)#
		}else{#
			text(x=x.spot1, y=p.height, "-", cex=text.size, srt=45)#
		}#
		if(dim(more.partitions.dat)[1] > 0){#
			text(x=x.spot2, y=p.height, format(as.numeric(wilcox.test(more.partitions.dat$no.part.raw, more.partitions.dat$part.raw, paired=TRUE, alternative="two.sided")$p.value), digits=2), cex=text.size, srt=45)#
		}else{#
			text(x=x.spot1, y=p.height, "-", cex=text.size, srt=45)#
		}#
	}#
}#
#####################################
#####################################
samp.size.col <- c("steelblue4", "darkorange2", "green4", "red3")#
opac <- 0.75#
outline.col <- "gray30"#
samp.sizes <- c(10,20,40,80)#
#####################################
ylim1 <- c(-0.25, 0.3)#
#ylim1 <- c(-0.1, 0.1)#
#ylim2 <- c(-1.35, 1.35)#
ylim2 <- c(-2.25, 2.25)#
ylim3 <- c(0.5,8)#
box.width <- 0.75#
line.type <- 1#
line.width <- 1.5#
ytext1 <- 0.15#
ytext2 <- 1.4#
p.height1 <- 0.26#
p.height.factor1=0.04#
#p.height2 <- 1.375#
p.height2 <- 1.075#
p.height.factor2=0.2#
text.size <- 0.7#
#criteria <- c("AIC", "BIC", "AICc")#
#for(criterion in criteria){#
criterion <- "BIC"#
if(criterion == "AIC") stat.data.set <- stat.data.set.AIC#
if(criterion == "BIC") stat.data.set <- stat.data.set.BIC#
if(criterion == "AICc") stat.data.set <- stat.data.set.AICc#
part.crit <- criterion#
#
pdf(paste(c("Results_Plots/Boxplots_", part.crit, "_IQtree-RAxML_ONLY_RFdist.pdf"), collapse=""), width=10, height=5)#
par(mar=c(2.5,4.25,1.75,0.25), mfrow=c(1,2))#
#_________________________________________________________________________________________________________##
#
plot(0, type="n", xlim=c(0.4,8.75), ylim=ylim1, xlab="", xaxt="n", ylab="Difference in Robinson Fould distance from true tree", main="IQtree", mgp=c(3,0.9,0))#
axis(side=1, at=c(2.5, 7), c("62 species simulated", "25 species simulated"))#
mtext(side=2, "(no partitioning - partitioning)", cex=0.75, line=2)#
abline(h=0, col="gray75", lty=3, lwd=1.5)#
#
# lopho (62 spp)#
plot.function(dat, dataset="lopho", tree.distance="rf_dist", x.spot.adjustment=0, p.height=p.height1, p.height.factor=p.height.factor1)#
#
# myria (25 spp)#
plot.function(dat, dataset="myria", tree.distance="rf_dist", x.spot.adjustment=4.5, p.height=p.height1, p.height.factor=p.height.factor1)#
#
legend("bottomright", c("10", "20", "40", "80"), pch=15, col=samp.size.col, title = "num. genes", cex=0.875, pt.cex=1.5) # , bg="white"#
# RAxML RF distance#
plot(0, type="n", xlim=c(0.4,8.75), ylim=ylim1, xlab="", xaxt="n", ylab="", main="RAxML", mgp=c(3,0.9,0))#
axis(side=1, at=c(2.5, 7), c("62 species simulated", "25 species simulated"))#
abline(h=0, col="gray75", lty=3, lwd=1.5)#
text(3,ytext1, expression(italic("partitioning better")), cex=1, col="green4")#
text(3,-ytext1, expression(italic("no partitioning better")), cex=1, col="red3")#
#
# lopho (62 spp)#
plot.function(dat, dataset="lopho", tree.distance="rf_dist_raxml", x.spot.adjustment=0, p.height=p.height1, p.height.factor=p.height.factor1)#
#
# myria (25 spp)#
plot.function(dat, dataset="myria", tree.distance="rf_dist_raxml", x.spot.adjustment=4.5, p.height=p.height1, p.height.factor=p.height.factor1)#
dev.off()
library(scales)#
#
setwd("~/Documents/UNIL/PartitioningMethods_SimulationProject/FunctioningPipeline/AnalysisResults")#
make.merge.id <- function(dat){#
	id.col <- rep(NA, dim(dat)[1])#
	for(i in 1:dim(dat)[1]){#
		if(length(grep("lopho", dat$file[i])) > 0) spp <- "lopho_"#
		if(length(grep("myria", dat$file[i])) > 0) spp <- "myria_"#
		if(length(grep("10", dat$file[i])) > 0) samp <- "10_"#
		if(length(grep("20", dat$file[i])) > 0) samp <- "20_"#
		if(length(grep("40", dat$file[i])) > 0) samp <- "40_"#
		if(length(grep("80", dat$file[i])) > 0) samp <- "80_"#
		if(length(grep("rcluster", dat$file[i])) > 0) algo <- "rcluster_"#
		if(length(grep("greedy", dat$file[i])) > 0) algo <- "greedy_"#
		if(length(grep("noPart", dat$file[i])) > 0) algo <- "noPart_"#
		if(length(grep("AIC", dat$file[i])) > 0) crit <- "AIC"#
		if(length(grep("AICc", dat$file[i])) > 0) crit <- "AICc"#
		if(length(grep("BIC", dat$file[i])) > 0) crit <- "BIC"#
		if(length(grep("noPart", dat$file[i])) > 0) crit <- "noPart"#
		id.col[i] <- paste(c(spp, samp, algo, crit), collapse="")#
	}#
	return(id.col)#
}#
make.merge.id2 <- function(dat){#
	id.col <- rep(NA, dim(dat)[1])#
	for(i in 1:dim(dat)[1]){#
		if(length(grep("lopho", dat$file[i])) > 0) spp <- "lopho_"#
		if(length(grep("myria", dat$file[i])) > 0) spp <- "myria_"#
		if(length(grep("10", dat$file[i])) > 0) samp <- "10_"#
		if(length(grep("20", dat$file[i])) > 0) samp <- "20_"#
		if(length(grep("40", dat$file[i])) > 0) samp <- "40_"#
		if(length(grep("80", dat$file[i])) > 0) samp <- "80_"#
		if(length(grep("r-", dat$file[i])) > 0) algo <- "rcluster_"#
		if(length(grep("greedy", dat$file[i])) > 0) algo <- "greedy_"#
		if(length(grep("noPart", dat$file[i])) > 0) algo <- "noPart_"#
		if(length(grep("-a", dat$file[i])) > 0) crit <- "AIC"#
		if(length(grep("-c", dat$file[i])) > 0) crit <- "AICc"#
		if(length(grep("-b", dat$file[i])) > 0) crit <- "BIC"#
		if(length(grep("noPart", dat$file[i])) > 0) crit <- "noPart"#
		id.col[i] <- paste(c(spp, samp, algo, crit), collapse="")#
	}#
	return(id.col)#
}#
get.rep.difference <- function(dat, rep, samp.size, spp, partitioning.criterion, distance){#
	temp.dat <- dat[dat$replicate == rep & dat$samp.size == samp.size & dat$species == spp , ]#
	no.part.result <- temp.dat[temp.dat$search.algo == "noPart" ,]#
	rclust.AIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AIC",]#
	rclust.BIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "BIC",]#
	rclust.AICc.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AICc",]#
	if(partitioning.criterion == "AIC"){#
		num.partitions.inferred <- rclust.AIC.result$num.partitions#
		if(dim(rclust.AIC.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.AIC.result[distance] }#
		part.dist <- rclust.AIC.result[distance]#
	}#
	if(partitioning.criterion == "BIC"){#
		num.partitions.inferred <- rclust.BIC.result$num.partitions#
		if(dim(rclust.BIC.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.BIC.result[distance] }#
		part.dist <- rclust.BIC.result[distance]#
	}#
	if(partitioning.criterion == "AICc"){#
		num.partitions.inferred <- rclust.AICc.result$num.partitions#
		if(dim(rclust.AICc.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.AICc.result[distance] }#
		part.dist <- rclust.AICc.result[distance]#
	}#
	return(c(no.part.result[distance], part.dist, as.numeric(difference), num.partitions.inferred))		#
}#
#
#####################################
#
get.boxplot.dat <- function(dat, samp.size, spp, partitioning.criterion, distance){	#
	samp.size.dists <- data.frame(matrix(NA, ncol=4))#
	names(samp.size.dists) <- c("no.part.raw", "part.raw", "distance", "num.parts")#
	for(j in unique(dat$replicate)){#
		result <- get.rep.difference(dat, rep=j, samp.size=samp.size, spp=spp, partitioning.criterion=partitioning.criterion, distance=distance)#
		#dist <- result[3]#
		#parts <- result[4]#
		samp.size.dists[j,] <- c(result[1], result[2], result[3], result[4])#
	}#
	return(samp.size.dists)#
}#
get.partition.dat <- function(dat, samp.size, spp, partitioning.criterion){	#
	partition.numbers <- NULL#
	for(j in unique(dat$replicate)){#
		temp.dat <- dat[dat$replicate == j & dat$samp.size == samp.size & dat$species == spp , ]#
		rclust.AIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AIC" ,]#
		rclust.BIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "BIC" ,]#
		rclust.AICc.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AICc",]#
		if(partitioning.criterion == "AIC"){#
			if(length(rclust.AIC.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.AIC.result$num.partitions }#
		}#
		if(partitioning.criterion == "BIC"){#
			if(length(rclust.BIC.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.BIC.result$num.partitions }#
		}#
		if(partitioning.criterion == "AICc"){#
			if(length(rclust.AICc.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.AICc.result$num.partitions }#
		}#
		partition.numbers <- c(partition.numbers, num.parts)#
	}#
	return(partition.numbers)#
}#
#
#####################################
# mut rate 1000#
#
infiles.a <- c("AllStatsOutput_New_Rep1_100-1000.csv",#
				"AllStatsOutput_New_Rep2_100-1000.csv",#
				"AllStatsOutput_New_Rep3_100-1000.csv",#
				"AllStatsOutput_New_Rep4_100-1000.csv",#
				"AllStatsOutput_New_Rep5_100-1000.csv",#
				"AllStatsOutput_New_Rep6_100-1000.csv",#
				"AllStatsOutput_Newest_Rep7_100-1000.csv",#
				"AllStatsOutput_Newest_Rep8_100-1000.csv",#
				"AllStatsOutput_Newest_Rep9_100-1000.csv",#
				"AllStatsOutput_Newest_Rep10_100-1000.csv",#
				"AllStatsOutput_Newest_Rep11_100-1000.csv",#
				"AllStatsOutput_Newest_Rep12_100-1000.csv",#
				"AllStatsOutput_Newest_Rep13_100-1000.csv",#
				"AllStatsOutput_Newest_Rep14_100-1000.csv",#
				"AllStatsOutput_Newest_Rep15_100-1000.csv",#
				"AllStatsOutput_Newest_Rep16_100-1000.csv",#
				"AllStatsOutput_Newest_Rep17_100-1000.csv",#
				"AllStatsOutput_Newest_Rep18_100-1000.csv",#
				"AllStatsOutput_Newest_Rep19_100-1000.csv",#
				"AllStatsOutput_Newest_Rep20_100-1000.csv",#
				"AllStatsOutput_Newest_Rep21_100-1000.csv",#
				"AllStatsOutput_Newest_Rep22_100-1000.csv",#
				"AllStatsOutput_Newest_Rep23_100-1000.csv",#
				"AllStatsOutput_Newest_Rep24_100-1000.csv",#
				"AllStatsOutput_Newest_Rep25_100-1000.csv",#
				"AllStatsOutput_Newest_Rep26_100-1000.csv",#
				"AllStatsOutput_Newest_Rep27_100-1000.csv",#
				"AllStatsOutput_Newest_Rep28_100-1000.csv",#
				"AllStatsOutput_Newest_Rep29_100-1000.csv",#
				"AllStatsOutput_Newest_Rep30_100-1000.csv",#
				"AllStatsOutput_Newest_Rep31_100-1000.csv",#
				"AllStatsOutput_Newest_Rep32_100-1000.csv",#
				"AllStatsOutput_Newest_Rep33_100-1000.csv",#
				"AllStatsOutput_Newest_Rep34_100-1000.csv",#
				"AllStatsOutput_Newest_Rep35_100-1000.csv"#
				)#
infiles.a2 <- c(	"AllStatsOutput_Rep1.csv",#
				"AllStatsOutput_Rep2.csv",#
				"AllStatsOutput_Rep3.csv",#
				"AllStatsOutput_Rep4.csv",#
				"AllStatsOutput_Rep5.csv",#
				"AllStatsOutput_Rep6.csv",#
				"AllStatsOutput_Rep7.csv",#
				"AllStatsOutput_Rep8.csv",#
				"AllStatsOutput_Rep9.csv",#
				"AllStatsOutput_Rep10.csv"#
				)#
# IQtree results#
infiles.b <- c("RF_Eucl_results_New_Rep1_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep2_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep3_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep4_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep5_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep6_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep7_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep8_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep9_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep10_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep11_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep12_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep13_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep14_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep15_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep16_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep17_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep18_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep19_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep20_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep21_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep22_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep23_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep24_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep25_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep26_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep27_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep28_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep29_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep30_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep31_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep32_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep33_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep34_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep35_100-1000_wConsensus.txt"#
				)#
infiles.b2 <- c(	"RF_Eucl_results_N10_Rep1_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep2_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep3_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep4_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep5_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep6_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep7_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep8_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep9_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep10_wConsensus.txt"#
				)#
## RAxML results#
infiles.c <- c("RF_Eucl_results_New_Rep1_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep2_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep3_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep4_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep5_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep6_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep7_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep8_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep9_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep10_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep11_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep12_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep13_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep14_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep15_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep16_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep17_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep18_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep19_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep20_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep21_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep22_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep23_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep24_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep25_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep26_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep27_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep28_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep29_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep30_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep31_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep32_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep33_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep34_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep35_100-1000_RAxML.txt"#
				)#
infiles.c2 <- c("RF_Eucl_results_N10_Rep1_RAxML.txt",#
				"RF_Eucl_results_N10_Rep2_RAxML.txt",#
				"RF_Eucl_results_N10_Rep3_RAxML.txt",#
				"RF_Eucl_results_N10_Rep4_RAxML.txt",#
				"RF_Eucl_results_N10_Rep5_RAxML.txt",#
				"RF_Eucl_results_N10_Rep6_RAxML.txt",#
				"RF_Eucl_results_N10_Rep7_RAxML.txt",#
				"RF_Eucl_results_N10_Rep8_RAxML.txt",#
				"RF_Eucl_results_N10_Rep9_RAxML.txt",#
				"RF_Eucl_results_N10_Rep10_RAxML.txt"#
				)#
dat <- NULL#
for(i in c(1:length(infiles.a))){ #**************UNCOMMENT ME FOR ALL REPS#
	temp.dat1 <- read.csv(infiles.a[i], header=TRUE, stringsAsFactors=FALSE)#
	temp.dat1$uniqueID <- paste(temp.dat1$species, temp.dat1$samp.size, temp.dat1$search.algo, temp.dat1$part.IC, sep="_")#
	temp.dat2 <- read.table(infiles.b[i], header=TRUE, stringsAsFactors=FALSE)#
	# because also have consenseus trees now:#
	temp.dat2 <- cbind(temp.dat2[1:32,], temp.dat2[33:64, 2:3])#
	names(temp.dat2) <- c("filename", "rf_dist", "eucl_dist", "cons_rf_dist", "cons_eucl_dist")#
	temp.dat2$uniqueID <- make.merge.id(temp.dat2)#
	temp.dat3 <- read.table(infiles.c[i], header=TRUE, stringsAsFactors=FALSE)#
	names(temp.dat3) <- c("filename_raxml", "rf_dist_raxml", "eucl_dist_raxml")#
	temp.dat3$uniqueID <- make.merge.id2(temp.dat3)#
	temp.temp.dat <- merge(temp.dat1, temp.dat2, by="uniqueID")#
	temp.dat <- merge(temp.temp.dat, temp.dat3, by="uniqueID")#
	temp.dat$gene.size <- 100#
	temp.dat$mut.rate <- 1000#
	temp.dat$replicate <- i#
#
	dat <- rbind(dat, temp.dat)#
}#
#
# additional 10 reps at only 10 species and all else same, plus 10 species with rate variation and no indel model#
dat2 <- NULL#
for(i in c(1:length(infiles.a2))){ #**************UNCOMMENT ME FOR ALL REPS#
	temp.dat1 <- read.csv(infiles.a2[i], header=TRUE, stringsAsFactors=FALSE)#
	temp.dat1$uniqueID <- paste(temp.dat1$species, temp.dat1$samp.size, temp.dat1$search.algo, temp.dat1$part.IC, sep="_")#
	temp.dat2 <- read.table(infiles.b2[i], header=TRUE, stringsAsFactors=FALSE)#
	# because also have consenseus trees now:#
	temp.dat2 <- cbind(temp.dat2[1:32,], temp.dat2[33:64, 2:3])#
	names(temp.dat2) <- c("filename", "rf_dist", "eucl_dist", "cons_rf_dist", "cons_eucl_dist")#
	temp.dat2$uniqueID <- make.merge.id(temp.dat2)#
	temp.dat3 <- read.table(infiles.c2[i], header=TRUE, stringsAsFactors=FALSE)#
	names(temp.dat3) <- c("filename_raxml", "rf_dist_raxml", "eucl_dist_raxml")#
	temp.dat3$uniqueID <- make.merge.id2(temp.dat3)#
	temp.temp.dat <- merge(temp.dat1, temp.dat2, by="uniqueID")#
	temp.dat <- merge(temp.temp.dat, temp.dat3, by="uniqueID")#
	temp.dat$gene.size <- 100#
	temp.dat$mut.rate <- 1000#
	temp.dat$replicate <- i#
	dat2 <- rbind(dat2, temp.dat)#
}#
dat2$uniqueID <- gsub('lopho','TenSpp', dat2$uniqueID)#
dat2$uniqueID <- gsub('myria','RateVar', dat2$uniqueID)#
dat2$species <- gsub('lopho','TenSpp', dat2$species)#
dat2$species <- gsub('myria','RateVar', dat2$species)#
#
dat <- rbind(dat, dat2)#
#
no.part.dat <- dat[dat$part.IC == "noPart" ,]#
#####################################
#
plot.function <- function(dat, dataset, tree.distance, x.spot.adjustment, p.height, p.height.factor){#
	if(dataset == "lopho"){#
		text(x=0.3, y=p.height+p.height.factor, "n=", cex=text.size)#
		text(x=0.3, y=p.height, "p=", cex=text.size)#
	}#
	for(i in 1:4){#
		x.spot1 <- i + x.spot.adjustment - 0.2#
		x.spot2 <- i + x.spot.adjustment + 0.2#
		plot.dat <- get.boxplot.dat(dat=dat, samp.size=samp.sizes[i], spp=dataset, partitioning.criterion=part.crit, distance=tree.distance)#
		one.partition.dat <- plot.dat[plot.dat$num.parts == 1 ,]#
		more.partitions.dat <- plot.dat[plot.dat$num.parts > 1 ,]#
		if(dim(one.partition.dat)[1] > 0){#
			 boxplot(one.partition.dat$distance, add=TRUE, at=x.spot1, pch=23, col=alpha(samp.size.col[i], opac), border=alpha(outline.col, opac), boxwex=box.width, lty=line.type, lwd=line.width, axes=FALSE)#
		}else{#
			#points(x.spot1, p.height, col="gray90", pch=15, cex=3)#
		}#
		if(dim(more.partitions.dat)[1] > 0){#
			boxplot(more.partitions.dat$distance, add=TRUE, at=x.spot2, pch=23, col=samp.size.col[i], border=outline.col, boxwex=box.width, lty=line.type, lwd=line.width, axes=FALSE)#
		}else{#
			##
		}#
		text(x=x.spot1, y=p.height+p.height.factor, paste(dim(one.partition.dat)[1]), cex=text.size, srt=45)#
		text(x=x.spot2, y=p.height+p.height.factor, paste(dim(more.partitions.dat)[1]), cex=text.size, srt=45)#
		if(dim(one.partition.dat)[1] > 0){#
			text(x=x.spot1, y=p.height, format(as.numeric(wilcox.test(one.partition.dat$no.part.raw, one.partition.dat$part.raw, paired=TRUE, alternative="two.sided")$p.value), digits=2), cex=text.size, srt=45)#
		}else{#
			text(x=x.spot1, y=p.height, "-", cex=text.size, srt=45)#
		}#
		if(dim(more.partitions.dat)[1] > 0){#
			text(x=x.spot2, y=p.height, format(as.numeric(wilcox.test(more.partitions.dat$no.part.raw, more.partitions.dat$part.raw, paired=TRUE, alternative="two.sided")$p.value), digits=2), cex=text.size, srt=45)#
		}else{#
			text(x=x.spot1, y=p.height, "-", cex=text.size, srt=45)#
		}#
	}#
}#
#####################################
#####################################
samp.size.col <- c("steelblue4", "darkorange2", "green4", "red3")#
opac <- 0.75#
outline.col <- "gray30"#
samp.sizes <- c(10,20,40,80)#
#####################################
ylim1 <- c(-0.25, 0.3)#
#ylim1 <- c(-0.1, 0.1)#
#ylim2 <- c(-1.35, 1.35)#
ylim2 <- c(-2.25, 2.25)#
ylim3 <- c(0.5,8)#
box.width <- 0.75#
line.type <- 1#
line.width <- 1.5#
ytext1 <- 0.15#
ytext2 <- 1.4#
p.height1 <- 0.26#
p.height.factor1=0.04#
#p.height2 <- 1.375#
p.height2 <- 1.075#
p.height.factor2=0.2#
text.size <- 0.7#
#criteria <- c("AIC", "BIC", "AICc")#
#for(criterion in criteria){#
criterion <- "BIC"#
if(criterion == "AIC") stat.data.set <- stat.data.set.AIC#
if(criterion == "BIC") stat.data.set <- stat.data.set.BIC#
if(criterion == "AICc") stat.data.set <- stat.data.set.AICc#
part.crit <- criterion#
#
pdf(paste(c("Results_Plots/Boxplots_", part.crit, "_IQtree-RAxML_ONLY_RFdist.pdf"), collapse=""), width=10, height=5)#
par(mar=c(2.5,4.25,1.75,0.25), mfrow=c(1,2))#
#_________________________________________________________________________________________________________##
#
plot(0, type="n", xlim=c(0.4,8.75), ylim=ylim1, xlab="", xaxt="n", ylab="Difference in Robinson Fould distance from true tree", main="IQtree", mgp=c(3,0.9,0))#
axis(side=1, at=c(2.5, 7), c("62 species simulated", "25 species simulated"))#
mtext(side=2, "(no partitioning - partitioning)", cex=0.75, line=2)#
abline(h=0, col="gray75", lty=3, lwd=1.5)#
#
# lopho (62 spp)#
plot.function(dat, dataset="lopho", tree.distance="rf_dist", x.spot.adjustment=0, p.height=p.height1, p.height.factor=p.height.factor1)#
#
# myria (25 spp)#
plot.function(dat, dataset="myria", tree.distance="rf_dist", x.spot.adjustment=4.5, p.height=p.height1, p.height.factor=p.height.factor1)#
#
legend("bottomright", c("10", "20", "40", "80"), pch=15, col=samp.size.col, title = "num. genes", cex=0.875, pt.cex=1.5) # , bg="white"#
# RAxML RF distance#
plot(0, type="n", xlim=c(0.4,8.75), ylim=ylim1, xlab="", xaxt="n", ylab="", main="RAxML", mgp=c(3,0.9,0))#
axis(side=1, at=c(2.5, 7), c("62 species simulated", "25 species simulated"))#
abline(h=0, col="gray75", lty=3, lwd=1.5)#
text(3,ytext1, expression(italic("partitioning better")), cex=1, col="green4")#
text(3,-ytext1, expression(italic("no partitioning better")), cex=1, col="red3")#
#
# lopho (62 spp)#
plot.function(dat, dataset="lopho", tree.distance="rf_dist_raxml", x.spot.adjustment=0, p.height=p.height1, p.height.factor=p.height.factor1)#
#
# myria (25 spp)#
plot.function(dat, dataset="myria", tree.distance="rf_dist_raxml", x.spot.adjustment=4.5, p.height=p.height1, p.height.factor=p.height.factor1)#
dev.off()
setwd("~/Documents/UNIL/PartitioningMethods_SimulationProject/FunctioningPipeline/AnalysisResults")#
make.merge.id <- function(dat){#
	id.col <- rep(NA, dim(dat)[1])#
	for(i in 1:dim(dat)[1]){#
		if(length(grep("lopho", dat$file[i])) > 0) spp <- "lopho_"#
		if(length(grep("myria", dat$file[i])) > 0) spp <- "myria_"#
		if(length(grep("10", dat$file[i])) > 0) samp <- "10_"#
		if(length(grep("20", dat$file[i])) > 0) samp <- "20_"#
		if(length(grep("40", dat$file[i])) > 0) samp <- "40_"#
		if(length(grep("80", dat$file[i])) > 0) samp <- "80_"#
		if(length(grep("rcluster", dat$file[i])) > 0) algo <- "rcluster_"#
		if(length(grep("greedy", dat$file[i])) > 0) algo <- "greedy_"#
		if(length(grep("noPart", dat$file[i])) > 0) algo <- "noPart_"#
		if(length(grep("AIC", dat$file[i])) > 0) crit <- "AIC"#
		if(length(grep("AICc", dat$file[i])) > 0) crit <- "AICc"#
		if(length(grep("BIC", dat$file[i])) > 0) crit <- "BIC"#
		if(length(grep("noPart", dat$file[i])) > 0) crit <- "noPart"#
		id.col[i] <- paste(c(spp, samp, algo, crit), collapse="")#
	}#
	return(id.col)#
}#
make.merge.id2 <- function(dat){#
	id.col <- rep(NA, dim(dat)[1])#
	for(i in 1:dim(dat)[1]){#
		if(length(grep("lopho", dat$file[i])) > 0) spp <- "lopho_"#
		if(length(grep("myria", dat$file[i])) > 0) spp <- "myria_"#
		if(length(grep("10", dat$file[i])) > 0) samp <- "10_"#
		if(length(grep("20", dat$file[i])) > 0) samp <- "20_"#
		if(length(grep("40", dat$file[i])) > 0) samp <- "40_"#
		if(length(grep("80", dat$file[i])) > 0) samp <- "80_"#
		if(length(grep("r-", dat$file[i])) > 0) algo <- "rcluster_"#
		if(length(grep("greedy", dat$file[i])) > 0) algo <- "greedy_"#
		if(length(grep("noPart", dat$file[i])) > 0) algo <- "noPart_"#
		if(length(grep("-a", dat$file[i])) > 0) crit <- "AIC"#
		if(length(grep("-c", dat$file[i])) > 0) crit <- "AICc"#
		if(length(grep("-b", dat$file[i])) > 0) crit <- "BIC"#
		if(length(grep("noPart", dat$file[i])) > 0) crit <- "noPart"#
		id.col[i] <- paste(c(spp, samp, algo, crit), collapse="")#
	}#
	return(id.col)#
}#
get.rep.difference <- function(dat, rep, samp.size, spp, partitioning.criterion, distance){#
	temp.dat <- dat[dat$replicate == rep & dat$samp.size == samp.size & dat$species == spp , ]#
	no.part.result <- temp.dat[temp.dat$search.algo == "noPart" ,]#
	rclust.AIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AIC",]#
	rclust.BIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "BIC",]#
	rclust.AICc.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AICc",]#
	if(partitioning.criterion == "AIC"){#
		num.partitions.inferred <- rclust.AIC.result$num.partitions#
		if(dim(rclust.AIC.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.AIC.result[distance] }#
		part.dist <- rclust.AIC.result[distance]#
	}#
	if(partitioning.criterion == "BIC"){#
		num.partitions.inferred <- rclust.BIC.result$num.partitions#
		if(dim(rclust.BIC.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.BIC.result[distance] }#
		part.dist <- rclust.BIC.result[distance]#
	}#
	if(partitioning.criterion == "AICc"){#
		num.partitions.inferred <- rclust.AICc.result$num.partitions#
		if(dim(rclust.AICc.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.AICc.result[distance] }#
		part.dist <- rclust.AICc.result[distance]#
	}#
	return(c(no.part.result[distance], part.dist, as.numeric(difference), num.partitions.inferred))		#
}#
#
#####################################
#
get.boxplot.dat <- function(dat, samp.size, spp, partitioning.criterion, distance){	#
	samp.size.dists <- data.frame(matrix(NA, ncol=4))#
	names(samp.size.dists) <- c("no.part.raw", "part.raw", "distance", "num.parts")#
	for(j in unique(dat$replicate)){#
		result <- get.rep.difference(dat, rep=j, samp.size=samp.size, spp=spp, partitioning.criterion=partitioning.criterion, distance=distance)#
		#dist <- result[3]#
		#parts <- result[4]#
		samp.size.dists[j,] <- c(result[1], result[2], result[3], result[4])#
	}#
	return(samp.size.dists)#
}#
get.partition.dat <- function(dat, samp.size, spp, partitioning.criterion){	#
	partition.numbers <- NULL#
	for(j in unique(dat$replicate)){#
		temp.dat <- dat[dat$replicate == j & dat$samp.size == samp.size & dat$species == spp , ]#
		rclust.AIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AIC" ,]#
		rclust.BIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "BIC" ,]#
		rclust.AICc.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AICc",]#
		if(partitioning.criterion == "AIC"){#
			if(length(rclust.AIC.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.AIC.result$num.partitions }#
		}#
		if(partitioning.criterion == "BIC"){#
			if(length(rclust.BIC.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.BIC.result$num.partitions }#
		}#
		if(partitioning.criterion == "AICc"){#
			if(length(rclust.AICc.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.AICc.result$num.partitions }#
		}#
		partition.numbers <- c(partition.numbers, num.parts)#
	}#
	return(partition.numbers)#
}#
#
#####################################
# mut rate 1000#
#
infiles.a <- c("AllStatsOutput_New_Rep1_100-1000.csv",#
				"AllStatsOutput_New_Rep2_100-1000.csv",#
				"AllStatsOutput_New_Rep3_100-1000.csv",#
				"AllStatsOutput_New_Rep4_100-1000.csv",#
				"AllStatsOutput_New_Rep5_100-1000.csv",#
				"AllStatsOutput_New_Rep6_100-1000.csv",#
				"AllStatsOutput_Newest_Rep7_100-1000.csv",#
				"AllStatsOutput_Newest_Rep8_100-1000.csv",#
				"AllStatsOutput_Newest_Rep9_100-1000.csv",#
				"AllStatsOutput_Newest_Rep10_100-1000.csv",#
				"AllStatsOutput_Newest_Rep11_100-1000.csv",#
				"AllStatsOutput_Newest_Rep12_100-1000.csv",#
				"AllStatsOutput_Newest_Rep13_100-1000.csv",#
				"AllStatsOutput_Newest_Rep14_100-1000.csv",#
				"AllStatsOutput_Newest_Rep15_100-1000.csv",#
				"AllStatsOutput_Newest_Rep16_100-1000.csv",#
				"AllStatsOutput_Newest_Rep17_100-1000.csv",#
				"AllStatsOutput_Newest_Rep18_100-1000.csv",#
				"AllStatsOutput_Newest_Rep19_100-1000.csv",#
				"AllStatsOutput_Newest_Rep20_100-1000.csv",#
				"AllStatsOutput_Newest_Rep21_100-1000.csv",#
				"AllStatsOutput_Newest_Rep22_100-1000.csv",#
				"AllStatsOutput_Newest_Rep23_100-1000.csv",#
				"AllStatsOutput_Newest_Rep24_100-1000.csv",#
				"AllStatsOutput_Newest_Rep25_100-1000.csv",#
				"AllStatsOutput_Newest_Rep26_100-1000.csv",#
				"AllStatsOutput_Newest_Rep27_100-1000.csv",#
				"AllStatsOutput_Newest_Rep28_100-1000.csv",#
				"AllStatsOutput_Newest_Rep29_100-1000.csv",#
				"AllStatsOutput_Newest_Rep30_100-1000.csv",#
				"AllStatsOutput_Newest_Rep31_100-1000.csv",#
				"AllStatsOutput_Newest_Rep32_100-1000.csv",#
				"AllStatsOutput_Newest_Rep33_100-1000.csv",#
				"AllStatsOutput_Newest_Rep34_100-1000.csv",#
				"AllStatsOutput_Newest_Rep35_100-1000.csv"#
				)#
infiles.a2 <- c(	"AllStatsOutput_Rep1.csv",#
				"AllStatsOutput_Rep2.csv",#
				"AllStatsOutput_Rep3.csv",#
				"AllStatsOutput_Rep4.csv",#
				"AllStatsOutput_Rep5.csv",#
				"AllStatsOutput_Rep6.csv",#
				"AllStatsOutput_Rep7.csv",#
				"AllStatsOutput_Rep8.csv",#
				"AllStatsOutput_Rep9.csv",#
				"AllStatsOutput_Rep10.csv"#
				)#
# IQtree results#
infiles.b <- c("RF_Eucl_results_New_Rep1_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep2_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep3_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep4_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep5_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep6_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep7_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep8_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep9_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep10_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep11_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep12_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep13_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep14_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep15_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep16_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep17_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep18_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep19_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep20_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep21_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep22_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep23_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep24_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep25_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep26_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep27_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep28_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep29_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep30_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep31_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep32_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep33_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep34_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep35_100-1000_wConsensus.txt"#
				)#
infiles.b2 <- c(	"RF_Eucl_results_N10_Rep1_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep2_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep3_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep4_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep5_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep6_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep7_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep8_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep9_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep10_wConsensus.txt"#
				)#
## RAxML results#
infiles.c <- c("RF_Eucl_results_New_Rep1_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep2_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep3_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep4_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep5_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep6_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep7_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep8_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep9_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep10_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep11_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep12_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep13_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep14_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep15_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep16_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep17_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep18_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep19_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep20_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep21_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep22_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep23_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep24_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep25_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep26_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep27_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep28_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep29_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep30_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep31_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep32_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep33_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep34_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep35_100-1000_RAxML.txt"#
				)#
infiles.c2 <- c("RF_Eucl_results_N10_Rep1_RAxML.txt",#
				"RF_Eucl_results_N10_Rep2_RAxML.txt",#
				"RF_Eucl_results_N10_Rep3_RAxML.txt",#
				"RF_Eucl_results_N10_Rep4_RAxML.txt",#
				"RF_Eucl_results_N10_Rep5_RAxML.txt",#
				"RF_Eucl_results_N10_Rep6_RAxML.txt",#
				"RF_Eucl_results_N10_Rep7_RAxML.txt",#
				"RF_Eucl_results_N10_Rep8_RAxML.txt",#
				"RF_Eucl_results_N10_Rep9_RAxML.txt",#
				"RF_Eucl_results_N10_Rep10_RAxML.txt"#
				)#
dat <- NULL#
for(i in c(1:length(infiles.a))){ #**************UNCOMMENT ME FOR ALL REPS#
	temp.dat1 <- read.csv(infiles.a[i], header=TRUE, stringsAsFactors=FALSE)#
	temp.dat1$uniqueID <- paste(temp.dat1$species, temp.dat1$samp.size, temp.dat1$search.algo, temp.dat1$part.IC, sep="_")#
	temp.dat2 <- read.table(infiles.b[i], header=TRUE, stringsAsFactors=FALSE)#
	# because also have consenseus trees now:#
	temp.dat2 <- cbind(temp.dat2[1:32,], temp.dat2[33:64, 2:3])#
	names(temp.dat2) <- c("filename", "rf_dist", "eucl_dist", "cons_rf_dist", "cons_eucl_dist")#
	temp.dat2$uniqueID <- make.merge.id(temp.dat2)#
	temp.dat3 <- read.table(infiles.c[i], header=TRUE, stringsAsFactors=FALSE)#
	names(temp.dat3) <- c("filename_raxml", "rf_dist_raxml", "eucl_dist_raxml")#
	temp.dat3$uniqueID <- make.merge.id2(temp.dat3)#
	temp.temp.dat <- merge(temp.dat1, temp.dat2, by="uniqueID")#
	temp.dat <- merge(temp.temp.dat, temp.dat3, by="uniqueID")#
	temp.dat$gene.size <- 100#
	temp.dat$mut.rate <- 1000#
	temp.dat$replicate <- i#
#
	dat <- rbind(dat, temp.dat)#
}#
#
# additional 10 reps at only 10 species and all else same, plus 10 species with rate variation and no indel model#
dat2 <- NULL#
for(i in c(1:length(infiles.a2))){ #**************UNCOMMENT ME FOR ALL REPS#
	temp.dat1 <- read.csv(infiles.a2[i], header=TRUE, stringsAsFactors=FALSE)#
	temp.dat1$uniqueID <- paste(temp.dat1$species, temp.dat1$samp.size, temp.dat1$search.algo, temp.dat1$part.IC, sep="_")#
	temp.dat2 <- read.table(infiles.b2[i], header=TRUE, stringsAsFactors=FALSE)#
	# because also have consenseus trees now:#
	temp.dat2 <- cbind(temp.dat2[1:32,], temp.dat2[33:64, 2:3])#
	names(temp.dat2) <- c("filename", "rf_dist", "eucl_dist", "cons_rf_dist", "cons_eucl_dist")#
	temp.dat2$uniqueID <- make.merge.id(temp.dat2)#
	temp.dat3 <- read.table(infiles.c2[i], header=TRUE, stringsAsFactors=FALSE)#
	names(temp.dat3) <- c("filename_raxml", "rf_dist_raxml", "eucl_dist_raxml")#
	temp.dat3$uniqueID <- make.merge.id2(temp.dat3)#
	temp.temp.dat <- merge(temp.dat1, temp.dat2, by="uniqueID")#
	temp.dat <- merge(temp.temp.dat, temp.dat3, by="uniqueID")#
	temp.dat$gene.size <- 100#
	temp.dat$mut.rate <- 1000#
	temp.dat$replicate <- i#
	dat2 <- rbind(dat2, temp.dat)#
}#
dat2$uniqueID <- gsub('lopho','TenSpp', dat2$uniqueID)#
dat2$uniqueID <- gsub('myria','RateVar', dat2$uniqueID)#
dat2$species <- gsub('lopho','TenSpp', dat2$species)#
dat2$species <- gsub('myria','RateVar', dat2$species)#
#
dat <- rbind(dat, dat2)#
#
no.part.dat <- dat[dat$part.IC == "noPart" ,]#
#####################################
#
plot.function <- function(dat, dataset, tree.distance, x.spot.adjustment, p.height, p.height.factor){#
	if(dataset == "lopho"){#
		text(x=0.3, y=p.height+p.height.factor, "n=", cex=text.size)#
		text(x=0.3, y=p.height, "p=", cex=text.size)#
	}#
	for(i in 1:4){#
		x.spot1 <- i + x.spot.adjustment - 0.2#
		x.spot2 <- i + x.spot.adjustment + 0.2#
		plot.dat <- get.boxplot.dat(dat=dat, samp.size=samp.sizes[i], spp=dataset, partitioning.criterion=part.crit, distance=tree.distance)#
		one.partition.dat <- plot.dat[plot.dat$num.parts == 1 ,]#
		more.partitions.dat <- plot.dat[plot.dat$num.parts > 1 ,]#
		if(dim(one.partition.dat)[1] > 0){#
			 boxplot(one.partition.dat$distance, add=TRUE, at=x.spot1, pch=23, col=alpha(samp.size.col[i], opac), border=alpha(outline.col, opac), boxwex=box.width, lty=line.type, lwd=line.width, axes=FALSE)#
		}else{#
			#points(x.spot1, p.height, col="gray90", pch=15, cex=3)#
		}#
		if(dim(more.partitions.dat)[1] > 0){#
			boxplot(more.partitions.dat$distance, add=TRUE, at=x.spot2, pch=23, col=samp.size.col[i], border=outline.col, boxwex=box.width, lty=line.type, lwd=line.width, axes=FALSE)#
		}else{#
			##
		}#
		text(x=x.spot1, y=p.height+p.height.factor, paste(dim(one.partition.dat)[1]), cex=text.size, srt=45)#
		text(x=x.spot2, y=p.height+p.height.factor, paste(dim(more.partitions.dat)[1]), cex=text.size, srt=45)#
		if(dim(one.partition.dat)[1] > 0){#
			text(x=x.spot1, y=p.height, format(as.numeric(wilcox.test(one.partition.dat$no.part.raw, one.partition.dat$part.raw, paired=TRUE, alternative="two.sided")$p.value), digits=2), cex=text.size, srt=45)#
		}else{#
			text(x=x.spot1, y=p.height, "-", cex=text.size, srt=45)#
		}#
		if(dim(more.partitions.dat)[1] > 0){#
			text(x=x.spot2, y=p.height, format(as.numeric(wilcox.test(more.partitions.dat$no.part.raw, more.partitions.dat$part.raw, paired=TRUE, alternative="two.sided")$p.value), digits=2), cex=text.size, srt=45)#
		}else{#
			text(x=x.spot1, y=p.height, "-", cex=text.size, srt=45)#
		}#
	}#
}#
#####################################
#####################################
samp.size.col <- c("steelblue4", "darkorange2", "green4", "red3")#
opac <- 0.75#
outline.col <- "gray30"#
samp.sizes <- c(10,20,40,80)#
#####################################
ylim1 <- c(-0.25, 0.3)#
#ylim1 <- c(-0.1, 0.1)#
#ylim2 <- c(-1.35, 1.35)#
ylim2 <- c(-1.3, 1.4)#
ylim3 <- c(0.5,8)#
box.width <- 0.75#
line.type <- 1#
line.width <- 1.5#
ytext1 <- 0.15#
ytext2 <- 0.5#
p.height1 <- 0.26#
p.height.factor1=0.04#
#p.height2 <- 1.375#
p.height2 <- 1.225#
p.height.factor2=0.2#
text.size <- 0.7#
#criteria <- c("AIC", "BIC", "AICc")#
#for(criterion in criteria){#
criterion <- "BIC"#
if(criterion == "AIC") stat.data.set <- stat.data.set.AIC#
if(criterion == "BIC") stat.data.set <- stat.data.set.BIC#
if(criterion == "AICc") stat.data.set <- stat.data.set.AICc#
part.crit <- criterion#
#
pdf(paste(c("Results_Plots/Boxplots_", part.crit, "_IQtree-RAxML_ONLY_Eucldist.pdf"), collapse=""), width=10, height=5)#
par(mar=c(2.5,4.25,1.75,0.25), mfrow=c(1,2))#
#_________________________________________________________________________________________________________##
#
plot(0, type="n", xlim=c(0.4,8.75), ylim=ylim2, xlab="", xaxt="n", ylab="Difference in Euclidean distance from true tree", main="IQtree", mgp=c(3,0.9,0))#
axis(side=1, at=c(2.5, 7), c("62 species simulated", "25 species simulated"))#
mtext(side=2, "(no partitioning - partitioning)", cex=0.75, line=2)#
abline(h=0, col="gray75", lty=3, lwd=1.5)#
#
# lopho (62 spp)#
plot.function(dat, dataset="lopho", tree.distance="eucl_dist", x.spot.adjustment=0, p.height=p.height2, p.height.factor=p.height.factor2)#
#
# myria (25 spp)#
plot.function(dat, dataset="myria", tree.distance="eucl_dist", x.spot.adjustment=4.5, p.height=p.height2, p.height.factor=p.height.factor2)#
# RAxML RF distance#
plot(0, type="n", xlim=c(0.4,8.75), ylim=ylim2, xlab="", xaxt="n", ylab="", main="RAxML", mgp=c(3,0.9,0))#
axis(side=1, at=c(2.5, 7), c("62 species simulated", "25 species simulated"))#
abline(h=0, col="gray75", lty=3, lwd=1.5)#
text(3,ytext2, expression(italic("partitioning better")), cex=1, col="green4")#
text(3,-ytext2, expression(italic("no partitioning better")), cex=1, col="red3")#
#
# lopho (62 spp)#
plot.function(dat, dataset="lopho", tree.distance="eucl_dist_raxml", x.spot.adjustment=0, p.height=p.height2, p.height.factor=p.height.factor2)#
#
# myria (25 spp)#
plot.function(dat, dataset="myria", tree.distance="eucl_dist_raxml", x.spot.adjustment=4.5, p.height=p.height2, p.height.factor=p.height.factor2)#
#
legend("bottom", c("10", "20", "40", "80"), pch=15, col=samp.size.col, title = "num. genes", cex=0.875, pt.cex=1.5) # , bg="white"#
dev.off()
library(scales)#
#
setwd("~/Documents/UNIL/PartitioningMethods_SimulationProject/FunctioningPipeline/AnalysisResults")#
make.merge.id <- function(dat){#
	id.col <- rep(NA, dim(dat)[1])#
	for(i in 1:dim(dat)[1]){#
		if(length(grep("lopho", dat$file[i])) > 0) spp <- "lopho_"#
		if(length(grep("myria", dat$file[i])) > 0) spp <- "myria_"#
		if(length(grep("10", dat$file[i])) > 0) samp <- "10_"#
		if(length(grep("20", dat$file[i])) > 0) samp <- "20_"#
		if(length(grep("40", dat$file[i])) > 0) samp <- "40_"#
		if(length(grep("80", dat$file[i])) > 0) samp <- "80_"#
		if(length(grep("rcluster", dat$file[i])) > 0) algo <- "rcluster_"#
		if(length(grep("greedy", dat$file[i])) > 0) algo <- "greedy_"#
		if(length(grep("noPart", dat$file[i])) > 0) algo <- "noPart_"#
		if(length(grep("AIC", dat$file[i])) > 0) crit <- "AIC"#
		if(length(grep("AICc", dat$file[i])) > 0) crit <- "AICc"#
		if(length(grep("BIC", dat$file[i])) > 0) crit <- "BIC"#
		if(length(grep("noPart", dat$file[i])) > 0) crit <- "noPart"#
		id.col[i] <- paste(c(spp, samp, algo, crit), collapse="")#
	}#
	return(id.col)#
}#
make.merge.id2 <- function(dat){#
	id.col <- rep(NA, dim(dat)[1])#
	for(i in 1:dim(dat)[1]){#
		if(length(grep("lopho", dat$file[i])) > 0) spp <- "lopho_"#
		if(length(grep("myria", dat$file[i])) > 0) spp <- "myria_"#
		if(length(grep("10", dat$file[i])) > 0) samp <- "10_"#
		if(length(grep("20", dat$file[i])) > 0) samp <- "20_"#
		if(length(grep("40", dat$file[i])) > 0) samp <- "40_"#
		if(length(grep("80", dat$file[i])) > 0) samp <- "80_"#
		if(length(grep("r-", dat$file[i])) > 0) algo <- "rcluster_"#
		if(length(grep("greedy", dat$file[i])) > 0) algo <- "greedy_"#
		if(length(grep("noPart", dat$file[i])) > 0) algo <- "noPart_"#
		if(length(grep("-a", dat$file[i])) > 0) crit <- "AIC"#
		if(length(grep("-c", dat$file[i])) > 0) crit <- "AICc"#
		if(length(grep("-b", dat$file[i])) > 0) crit <- "BIC"#
		if(length(grep("noPart", dat$file[i])) > 0) crit <- "noPart"#
		id.col[i] <- paste(c(spp, samp, algo, crit), collapse="")#
	}#
	return(id.col)#
}#
get.rep.difference <- function(dat, rep, samp.size, spp, partitioning.criterion, distance){#
	temp.dat <- dat[dat$replicate == rep & dat$samp.size == samp.size & dat$species == spp , ]#
	no.part.result <- temp.dat[temp.dat$search.algo == "noPart" ,]#
	rclust.AIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AIC",]#
	rclust.BIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "BIC",]#
	rclust.AICc.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AICc",]#
	if(partitioning.criterion == "AIC"){#
		num.partitions.inferred <- rclust.AIC.result$num.partitions#
		if(dim(rclust.AIC.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.AIC.result[distance] }#
		part.dist <- rclust.AIC.result[distance]#
	}#
	if(partitioning.criterion == "BIC"){#
		num.partitions.inferred <- rclust.BIC.result$num.partitions#
		if(dim(rclust.BIC.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.BIC.result[distance] }#
		part.dist <- rclust.BIC.result[distance]#
	}#
	if(partitioning.criterion == "AICc"){#
		num.partitions.inferred <- rclust.AICc.result$num.partitions#
		if(dim(rclust.AICc.result[distance])[1] == 0 | dim(no.part.result[distance])[1] == 0){ difference <- NA}#
		else{ difference <- no.part.result[distance] - rclust.AICc.result[distance] }#
		part.dist <- rclust.AICc.result[distance]#
	}#
	return(c(no.part.result[distance], part.dist, as.numeric(difference), num.partitions.inferred))		#
}#
#
#####################################
#
get.boxplot.dat <- function(dat, samp.size, spp, partitioning.criterion, distance){	#
	samp.size.dists <- data.frame(matrix(NA, ncol=4))#
	names(samp.size.dists) <- c("no.part.raw", "part.raw", "distance", "num.parts")#
	for(j in unique(dat$replicate)){#
		result <- get.rep.difference(dat, rep=j, samp.size=samp.size, spp=spp, partitioning.criterion=partitioning.criterion, distance=distance)#
		#dist <- result[3]#
		#parts <- result[4]#
		samp.size.dists[j,] <- c(result[1], result[2], result[3], result[4])#
	}#
	return(samp.size.dists)#
}#
get.partition.dat <- function(dat, samp.size, spp, partitioning.criterion){	#
	partition.numbers <- NULL#
	for(j in unique(dat$replicate)){#
		temp.dat <- dat[dat$replicate == j & dat$samp.size == samp.size & dat$species == spp , ]#
		rclust.AIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AIC" ,]#
		rclust.BIC.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "BIC" ,]#
		rclust.AICc.result <- temp.dat[temp.dat$search.algo == "rcluster" & temp.dat$part.IC == "AICc",]#
		if(partitioning.criterion == "AIC"){#
			if(length(rclust.AIC.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.AIC.result$num.partitions }#
		}#
		if(partitioning.criterion == "BIC"){#
			if(length(rclust.BIC.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.BIC.result$num.partitions }#
		}#
		if(partitioning.criterion == "AICc"){#
			if(length(rclust.AICc.result$num.partitions)[1] == 0){ num.parts <- NA}#
			else{ num.parts <- rclust.AICc.result$num.partitions }#
		}#
		partition.numbers <- c(partition.numbers, num.parts)#
	}#
	return(partition.numbers)#
}#
#
#####################################
# mut rate 1000#
#
infiles.a <- c("AllStatsOutput_New_Rep1_100-1000.csv",#
				"AllStatsOutput_New_Rep2_100-1000.csv",#
				"AllStatsOutput_New_Rep3_100-1000.csv",#
				"AllStatsOutput_New_Rep4_100-1000.csv",#
				"AllStatsOutput_New_Rep5_100-1000.csv",#
				"AllStatsOutput_New_Rep6_100-1000.csv",#
				"AllStatsOutput_Newest_Rep7_100-1000.csv",#
				"AllStatsOutput_Newest_Rep8_100-1000.csv",#
				"AllStatsOutput_Newest_Rep9_100-1000.csv",#
				"AllStatsOutput_Newest_Rep10_100-1000.csv",#
				"AllStatsOutput_Newest_Rep11_100-1000.csv",#
				"AllStatsOutput_Newest_Rep12_100-1000.csv",#
				"AllStatsOutput_Newest_Rep13_100-1000.csv",#
				"AllStatsOutput_Newest_Rep14_100-1000.csv",#
				"AllStatsOutput_Newest_Rep15_100-1000.csv",#
				"AllStatsOutput_Newest_Rep16_100-1000.csv",#
				"AllStatsOutput_Newest_Rep17_100-1000.csv",#
				"AllStatsOutput_Newest_Rep18_100-1000.csv",#
				"AllStatsOutput_Newest_Rep19_100-1000.csv",#
				"AllStatsOutput_Newest_Rep20_100-1000.csv",#
				"AllStatsOutput_Newest_Rep21_100-1000.csv",#
				"AllStatsOutput_Newest_Rep22_100-1000.csv",#
				"AllStatsOutput_Newest_Rep23_100-1000.csv",#
				"AllStatsOutput_Newest_Rep24_100-1000.csv",#
				"AllStatsOutput_Newest_Rep25_100-1000.csv",#
				"AllStatsOutput_Newest_Rep26_100-1000.csv",#
				"AllStatsOutput_Newest_Rep27_100-1000.csv",#
				"AllStatsOutput_Newest_Rep28_100-1000.csv",#
				"AllStatsOutput_Newest_Rep29_100-1000.csv",#
				"AllStatsOutput_Newest_Rep30_100-1000.csv",#
				"AllStatsOutput_Newest_Rep31_100-1000.csv",#
				"AllStatsOutput_Newest_Rep32_100-1000.csv",#
				"AllStatsOutput_Newest_Rep33_100-1000.csv",#
				"AllStatsOutput_Newest_Rep34_100-1000.csv",#
				"AllStatsOutput_Newest_Rep35_100-1000.csv"#
				)#
infiles.a2 <- c(	"AllStatsOutput_Rep1.csv",#
				"AllStatsOutput_Rep2.csv",#
				"AllStatsOutput_Rep3.csv",#
				"AllStatsOutput_Rep4.csv",#
				"AllStatsOutput_Rep5.csv",#
				"AllStatsOutput_Rep6.csv",#
				"AllStatsOutput_Rep7.csv",#
				"AllStatsOutput_Rep8.csv",#
				"AllStatsOutput_Rep9.csv",#
				"AllStatsOutput_Rep10.csv"#
				)#
# IQtree results#
infiles.b <- c("RF_Eucl_results_New_Rep1_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep2_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep3_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep4_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep5_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep6_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep7_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep8_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep9_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep10_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep11_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep12_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep13_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep14_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep15_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep16_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep17_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep18_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep19_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep20_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep21_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep22_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep23_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep24_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep25_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep26_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep27_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep28_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep29_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep30_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep31_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep32_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep33_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep34_100-1000_wConsensus.txt",#
				"RF_Eucl_results_New_Rep35_100-1000_wConsensus.txt"#
				)#
infiles.b2 <- c(	"RF_Eucl_results_N10_Rep1_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep2_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep3_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep4_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep5_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep6_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep7_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep8_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep9_wConsensus.txt",#
				"RF_Eucl_results_N10_Rep10_wConsensus.txt"#
				)#
## RAxML results#
infiles.c <- c("RF_Eucl_results_New_Rep1_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep2_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep3_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep4_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep5_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep6_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep7_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep8_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep9_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep10_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep11_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep12_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep13_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep14_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep15_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep16_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep17_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep18_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep19_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep20_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep21_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep22_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep23_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep24_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep25_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep26_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep27_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep28_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep29_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep30_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep31_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep32_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep33_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep34_100-1000_RAxML.txt",#
				"RF_Eucl_results_New_Rep35_100-1000_RAxML.txt"#
				)#
infiles.c2 <- c("RF_Eucl_results_N10_Rep1_RAxML.txt",#
				"RF_Eucl_results_N10_Rep2_RAxML.txt",#
				"RF_Eucl_results_N10_Rep3_RAxML.txt",#
				"RF_Eucl_results_N10_Rep4_RAxML.txt",#
				"RF_Eucl_results_N10_Rep5_RAxML.txt",#
				"RF_Eucl_results_N10_Rep6_RAxML.txt",#
				"RF_Eucl_results_N10_Rep7_RAxML.txt",#
				"RF_Eucl_results_N10_Rep8_RAxML.txt",#
				"RF_Eucl_results_N10_Rep9_RAxML.txt",#
				"RF_Eucl_results_N10_Rep10_RAxML.txt"#
				)#
dat <- NULL#
for(i in c(1:length(infiles.a))){ #**************UNCOMMENT ME FOR ALL REPS#
	temp.dat1 <- read.csv(infiles.a[i], header=TRUE, stringsAsFactors=FALSE)#
	temp.dat1$uniqueID <- paste(temp.dat1$species, temp.dat1$samp.size, temp.dat1$search.algo, temp.dat1$part.IC, sep="_")#
	temp.dat2 <- read.table(infiles.b[i], header=TRUE, stringsAsFactors=FALSE)#
	# because also have consenseus trees now:#
	temp.dat2 <- cbind(temp.dat2[1:32,], temp.dat2[33:64, 2:3])#
	names(temp.dat2) <- c("filename", "rf_dist", "eucl_dist", "cons_rf_dist", "cons_eucl_dist")#
	temp.dat2$uniqueID <- make.merge.id(temp.dat2)#
	temp.dat3 <- read.table(infiles.c[i], header=TRUE, stringsAsFactors=FALSE)#
	names(temp.dat3) <- c("filename_raxml", "rf_dist_raxml", "eucl_dist_raxml")#
	temp.dat3$uniqueID <- make.merge.id2(temp.dat3)#
	temp.temp.dat <- merge(temp.dat1, temp.dat2, by="uniqueID")#
	temp.dat <- merge(temp.temp.dat, temp.dat3, by="uniqueID")#
	temp.dat$gene.size <- 100#
	temp.dat$mut.rate <- 1000#
	temp.dat$replicate <- i#
#
	dat <- rbind(dat, temp.dat)#
}#
#
# additional 10 reps at only 10 species and all else same, plus 10 species with rate variation and no indel model#
dat2 <- NULL#
for(i in c(1:length(infiles.a2))){ #**************UNCOMMENT ME FOR ALL REPS#
	temp.dat1 <- read.csv(infiles.a2[i], header=TRUE, stringsAsFactors=FALSE)#
	temp.dat1$uniqueID <- paste(temp.dat1$species, temp.dat1$samp.size, temp.dat1$search.algo, temp.dat1$part.IC, sep="_")#
	temp.dat2 <- read.table(infiles.b2[i], header=TRUE, stringsAsFactors=FALSE)#
	# because also have consenseus trees now:#
	temp.dat2 <- cbind(temp.dat2[1:32,], temp.dat2[33:64, 2:3])#
	names(temp.dat2) <- c("filename", "rf_dist", "eucl_dist", "cons_rf_dist", "cons_eucl_dist")#
	temp.dat2$uniqueID <- make.merge.id(temp.dat2)#
	temp.dat3 <- read.table(infiles.c2[i], header=TRUE, stringsAsFactors=FALSE)#
	names(temp.dat3) <- c("filename_raxml", "rf_dist_raxml", "eucl_dist_raxml")#
	temp.dat3$uniqueID <- make.merge.id2(temp.dat3)#
	temp.temp.dat <- merge(temp.dat1, temp.dat2, by="uniqueID")#
	temp.dat <- merge(temp.temp.dat, temp.dat3, by="uniqueID")#
	temp.dat$gene.size <- 100#
	temp.dat$mut.rate <- 1000#
	temp.dat$replicate <- i#
	dat2 <- rbind(dat2, temp.dat)#
}#
dat2$uniqueID <- gsub('lopho','TenSpp', dat2$uniqueID)#
dat2$uniqueID <- gsub('myria','RateVar', dat2$uniqueID)#
dat2$species <- gsub('lopho','TenSpp', dat2$species)#
dat2$species <- gsub('myria','RateVar', dat2$species)#
#
dat <- rbind(dat, dat2)#
#
no.part.dat <- dat[dat$part.IC == "noPart" ,]#
#####################################
#
plot.function <- function(dat, dataset, tree.distance, x.spot.adjustment, p.height, p.height.factor){#
	if(dataset == "lopho"){#
		text(x=0.3, y=p.height+p.height.factor, "n=", cex=text.size)#
		text(x=0.3, y=p.height, "p=", cex=text.size)#
	}#
	for(i in 1:4){#
		x.spot1 <- i + x.spot.adjustment - 0.2#
		x.spot2 <- i + x.spot.adjustment + 0.2#
		plot.dat <- get.boxplot.dat(dat=dat, samp.size=samp.sizes[i], spp=dataset, partitioning.criterion=part.crit, distance=tree.distance)#
		one.partition.dat <- plot.dat[plot.dat$num.parts == 1 ,]#
		more.partitions.dat <- plot.dat[plot.dat$num.parts > 1 ,]#
		if(dim(one.partition.dat)[1] > 0){#
			 boxplot(one.partition.dat$distance, add=TRUE, at=x.spot1, pch=23, col=alpha(samp.size.col[i], opac), border=alpha(outline.col, opac), boxwex=box.width, lty=line.type, lwd=line.width, axes=FALSE)#
		}else{#
			#points(x.spot1, p.height, col="gray90", pch=15, cex=3)#
		}#
		if(dim(more.partitions.dat)[1] > 0){#
			boxplot(more.partitions.dat$distance, add=TRUE, at=x.spot2, pch=23, col=samp.size.col[i], border=outline.col, boxwex=box.width, lty=line.type, lwd=line.width, axes=FALSE)#
		}else{#
			##
		}#
		text(x=x.spot1, y=p.height+p.height.factor, paste(dim(one.partition.dat)[1]), cex=text.size, srt=45)#
		text(x=x.spot2, y=p.height+p.height.factor, paste(dim(more.partitions.dat)[1]), cex=text.size, srt=45)#
		if(dim(one.partition.dat)[1] > 0){#
			text(x=x.spot1, y=p.height, format(as.numeric(wilcox.test(one.partition.dat$no.part.raw, one.partition.dat$part.raw, paired=TRUE, alternative="two.sided")$p.value), digits=2), cex=text.size, srt=45)#
		}else{#
			text(x=x.spot1, y=p.height, "-", cex=text.size, srt=45)#
		}#
		if(dim(more.partitions.dat)[1] > 0){#
			text(x=x.spot2, y=p.height, format(as.numeric(wilcox.test(more.partitions.dat$no.part.raw, more.partitions.dat$part.raw, paired=TRUE, alternative="two.sided")$p.value), digits=2), cex=text.size, srt=45)#
		}else{#
			text(x=x.spot1, y=p.height, "-", cex=text.size, srt=45)#
		}#
	}#
}#
#####################################
#####################################
samp.size.col <- c("steelblue4", "darkorange2", "green4", "red3")#
opac <- 0.75#
outline.col <- "gray30"#
samp.sizes <- c(10,20,40,80)#
#####################################
ylim1 <- c(-0.25, 0.3)#
#ylim1 <- c(-0.1, 0.1)#
#ylim2 <- c(-1.35, 1.35)#
ylim2 <- c(-1.3, 1.4)#
ylim3 <- c(0.5,8)#
box.width <- 0.75#
line.type <- 1#
line.width <- 1.5#
ytext1 <- 0.15#
ytext2 <- 0.5#
p.height1 <- 0.26#
p.height.factor1=0.04#
#p.height2 <- 1.375#
p.height2 <- 1.225#
p.height.factor2=0.2#
text.size <- 0.7#
#criteria <- c("AIC", "BIC", "AICc")#
#for(criterion in criteria){#
criterion <- "BIC"#
if(criterion == "AIC") stat.data.set <- stat.data.set.AIC#
if(criterion == "BIC") stat.data.set <- stat.data.set.BIC#
if(criterion == "AICc") stat.data.set <- stat.data.set.AICc#
part.crit <- criterion#
#
pdf(paste(c("Results_Plots/Boxplots_", part.crit, "_IQtree-RAxML_ONLY_Eucldist.pdf"), collapse=""), width=10, height=5)#
par(mar=c(2.5,4.25,1.75,0.25), mfrow=c(1,2))#
#_________________________________________________________________________________________________________##
#
plot(0, type="n", xlim=c(0.4,8.75), ylim=ylim2, xlab="", xaxt="n", ylab="Difference in Euclidean distance from true tree", main="IQtree", mgp=c(3,0.9,0))#
axis(side=1, at=c(2.5, 7), c("62 species simulated", "25 species simulated"))#
mtext(side=2, "(no partitioning - partitioning)", cex=0.75, line=2)#
abline(h=0, col="gray75", lty=3, lwd=1.5)#
#
# lopho (62 spp)#
plot.function(dat, dataset="lopho", tree.distance="eucl_dist", x.spot.adjustment=0, p.height=p.height2, p.height.factor=p.height.factor2)#
#
# myria (25 spp)#
plot.function(dat, dataset="myria", tree.distance="eucl_dist", x.spot.adjustment=4.5, p.height=p.height2, p.height.factor=p.height.factor2)#
# RAxML RF distance#
plot(0, type="n", xlim=c(0.4,8.75), ylim=ylim2, xlab="", xaxt="n", ylab="", main="RAxML", mgp=c(3,0.9,0))#
axis(side=1, at=c(2.5, 7), c("62 species simulated", "25 species simulated"))#
abline(h=0, col="gray75", lty=3, lwd=1.5)#
text(3,ytext2, expression(italic("partitioning better")), cex=1, col="green4")#
text(3,-ytext2, expression(italic("no partitioning better")), cex=1, col="red3")#
#
# lopho (62 spp)#
plot.function(dat, dataset="lopho", tree.distance="eucl_dist_raxml", x.spot.adjustment=0, p.height=p.height2, p.height.factor=p.height.factor2)#
#
# myria (25 spp)#
plot.function(dat, dataset="myria", tree.distance="eucl_dist_raxml", x.spot.adjustment=4.5, p.height=p.height2, p.height.factor=p.height.factor2)#
#
legend("bottom", c("10", "20", "40", "80"), pch=15, col=samp.size.col, title = "num. genes", cex=0.875, pt.cex=1.5) # , bg="white"#
dev.off()
